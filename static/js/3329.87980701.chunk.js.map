{"version":3,"file":"static/js/3329.87980701.chunk.js","mappings":"yQAI+MA,EAAE,SAACC,EAAEC,GAAC,OAAGD,EAAEE,IAAIC,MAAMF,EAAEC,IAAIC,OAAO,EAAEH,EAAEE,IAAIC,MAAMF,EAAEC,IAAIC,MAAMH,EAAEE,IAAIE,IAAIH,EAAEC,IAAIE,KAAK,EAAEJ,EAAEE,IAAIE,IAAIH,EAAEC,IAAIE,IAAIJ,EAAEE,IAAIG,IAAIJ,EAAEC,IAAIG,GAAG,EAAOC,EAAC,SAAAC,IAAAC,EAAAA,EAAAA,GAAAF,EAAAC,GAAA,IAAAE,GAAAC,EAAAA,EAAAA,GAAAJ,GAAW,SAAAA,EAAYN,GAAE,IAAAW,EAA6B,OAA7BC,EAAAA,EAAAA,GAAA,KAAAN,IAACK,EAAAF,EAAAI,KAAA,OAAaC,cAAcd,EAACW,CAAA,CAAmxB,OAAlxBI,EAAAA,EAAAA,GAAAT,EAAA,EAAAJ,IAAA,uBAAAc,IAAA,WAA2B,OAAM,CAAE,GAAC,CAAAd,IAAA,iBAAAe,MAAA,SAAejB,GAAGkB,KAAKC,aAAapB,GAAGmB,KAAKE,oBAAoBpB,IAAEqB,EAAAA,EAAAA,IAAAC,EAAAA,EAAAA,GAAAhB,EAAAiB,WAAA,uBAAAV,KAAA,KAAsBb,EAAE,GAAC,CAAAE,IAAA,qBAAAe,MAAA,SAAmBjB,GAAQ,IAAOC,EAAGD,EAATwB,MAAWC,GAACJ,EAAAA,EAAAA,IAAAC,EAAAA,EAAAA,GAAAhB,EAAAiB,WAAA,2BAAAV,KAAA,KAA0Bb,GAAG,OAAOyB,EAAEC,cAAcR,KAAKJ,cAAca,uBAAuB1B,EAAE2B,OAAOzB,MAAMsB,EAAEI,aAAaX,KAAKJ,cAAcgB,SAASC,YAAY9B,EAAE2B,OAAOH,CAAC,GAAC,CAAAvB,IAAA,sBAAAe,MAAA,SAAoBhB,GAAE,IAAA+B,EAAA,KAAOjC,GAACsB,EAAAA,EAAAA,IAAAC,EAAAA,EAAAA,GAAAhB,EAAAiB,WAAA,4BAAAV,KAAA,KAA2BZ,GAAG,OAAOF,EAAEkC,KAAKhC,EAAEiC,mBAAmB,CAACC,KAAK,UAAUC,QAAQ,CAACC,EAAAA,GAAGC,UAAUtC,EAAAA,GAAAA,MAAQA,EAAAA,GAAAA,IAAMA,EAAAA,GAAAA,UAAYuC,OAAO,kBAAIP,EAAKQ,kBAAkB,MAAIC,EAAAA,EAAAA,GAAI,qBAAqB1C,EAAEkC,KAAKhC,EAAEiC,mBAAmB,CAACC,KAAK,WAAWC,QAAQ,CAACX,EAAAA,GAAGa,UAAUtC,EAAAA,GAAAA,MAAQuC,OAAO,kBAAIP,EAAKU,QAAQ,KAAI3C,CAAC,GAAC,CAAAG,IAAA,mBAAAe,MAAA,WAAmB,OAAOC,KAAKwB,QAAQ,GAAC,CAAAxC,IAAA,sBAAAe,MAAA,SAAoBjB,GAAG,IAAoC2C,EAAhC1C,EAAE,EAAE2C,GAAAC,EAAAA,EAAAA,GAAe3B,KAAKwB,UAAQ,IAA5B,IAAAE,EAAAnB,MAAAkB,EAAAC,EAAA7C,KAAA+C,MAA6B,CAAlBH,EAAA1B,MAAoB8B,WAAW9C,GAAE,CAAC,OAAA+C,GAAAJ,EAAA5C,EAAAgD,EAAA,SAAAJ,EAAAK,GAAA,MAAC3C,CAAA,CAAz0B,CAASL,EAAAA,E,wXCAomBiD,EAAE,CAAC,OAAO,OAAO,KAAK,KAAK,QAAQC,EAAE,CAAC,EAAE,GAAOC,EAAC,SAAAC,IAAA7C,EAAAA,EAAAA,GAAA4C,EAAAC,GAAA,IAAA5C,GAAAC,EAAAA,EAAAA,GAAA0C,GAA2B,SAAAA,IAAa,IAAAzC,EAA6G,OAA7GC,EAAAA,EAAAA,GAAA,KAAAwC,IAACzC,EAAAF,EAAA6C,MAAA,KAASC,YAAgBC,cAAc,KAAK7C,EAAK8C,YAAY,KAAK9C,EAAK+C,cAAc,IAAIC,IAAIhD,EAAKiD,MAAM,KAAIjD,CAAA,CAAg1G,OAA/0GI,EAAAA,EAAAA,GAAAqC,EAAA,EAAAlD,IAAA,gBAAAc,IAAA,WAAoB,IAAMhB,EAAEkB,KAAK2C,oCAAoC3C,KAAK0C,MAAME,aAAa,OAAO9D,GAAGA,EAAE+D,KAAK7C,KAAK0C,MAAME,YAAYE,kBAAkB9C,KAAK0C,MAAME,YAAYE,gBAAgBhE,EAAE+D,IAAI/D,GAAG,IAAI,GAAC,CAAAE,IAAA,SAAAe,MAAA,SAAOjB,GAAGkB,KAAKuC,YAAYQ,QAAQ/C,KAAKuC,YAAYjC,MAAMxB,EAAEwB,MAAMN,KAAKsC,cAAcU,OAAOlE,GAAGkB,KAAKuC,YAAYU,QAAQ,GAAC,CAAAjE,IAAA,SAAAe,MAAA,WAAQ,IAAAmD,EAAApC,EAAA,KAAOhC,EAAoB,QAAnBoE,EAAClD,KAAKmD,qBAAa,IAAAD,OAAA,EAAlBA,EAAoBtC,SAAS9B,IAAIkB,KAAKJ,cAAc,IAAIf,EAAAA,EAAEC,GAAGkB,KAAKuC,YAAY,IAAIa,EAAAA,EAAE,CAACC,aAAarD,KAAKJ,cAAc0D,YAAY,GAAGC,QAAQ,SAACzE,EAAEqC,GAAC,OAAGL,EAAK0C,UAAU1E,EAAEqC,EAAE,IAAGnB,KAAKsC,cAAc,IAAIP,EAAAA,EAAE,CAAC0B,YAAY,OAAOC,YAAW,EAAGC,YAAY,SAAA7E,GAAC,OAAEgC,EAAK6C,YAAY7E,EAAE,EAAC8E,YAAY,SAAA9E,GAAC,OAAEgC,EAAK8C,YAAY9E,EAAE,EAACuE,aAAarD,KAAKJ,gBAAgBI,KAAK6D,kBAAiBtD,EAAAA,EAAAA,KAAG,eAAAuD,EAAAC,EAAA,MAAI,CAAW,QAAXD,EAAChD,EAAK4B,aAAK,IAAAoB,GAAa,QAAbC,EAAVD,EAAYlB,mBAAW,IAAAmB,OAAb,EAAVA,EAAyBC,QAAQlD,EAAKqC,cAAc,IAAG,kBAAIrC,EAAKmD,UAAU,MAAG9D,EAAAA,EAAAA,IAAAC,EAAAA,EAAAA,GAAA8B,EAAA7B,WAAA,eAAAV,KAAA,MAAgB,GAAC,CAAAX,IAAA,SAAAe,MAAA,WAAQ,IAAAmE,EAAAC,GAAChE,EAAAA,EAAAA,IAAAC,EAAAA,EAAAA,GAAA8B,EAAA7B,WAAA,eAAAV,KAAA,MAAiC,QAAjCuE,EAAelE,KAAKsC,qBAAa,IAAA4B,GAAlBA,EAAoBE,UAA0B,QAAjBD,EAACnE,KAAKuC,mBAAW,IAAA4B,GAAhBA,EAAkBC,UAAUpE,KAAKuC,YAAYvC,KAAKsC,cAActC,KAAKJ,cAAc,IAAI,GAAC,CAAAZ,IAAA,YAAAe,MAAA,WAAYC,KAAKqE,eAAe,GAAC,CAAArF,IAAA,aAAAe,MAAA,WAAaC,KAAKqE,eAAe,GAAC,CAAArF,IAAA,UAAAe,MAAA,WAAUC,KAAKqE,eAAe,GAAC,CAAArF,IAAA,cAAAe,MAAA,SAAYjB,GAAGkB,KAAKuC,YAAY+B,MAAMxF,EAAEE,IAAI6D,IAAI7C,KAAKuE,YAAYC,YAAY1F,GAAGA,EAAE2F,KAAK,UAAU,kBAAI3F,EAAEsF,SAAS,IAAGpE,KAAKqE,eAAe,GAAC,CAAArF,IAAA,cAAAe,MAAA,SAAYjB,GAAE,IAAA4F,EAAAC,EAAAC,EAAOzD,EAAEnB,KAAKuE,YAAYM,WAAW/F,GAAGM,EAAE+B,EAAE2D,OAAO,OAAMJ,EAAU1E,KAAKJ,cAAcmF,cAAc9C,EAAEd,EAAEnC,KAAI2F,GAAAK,EAAAA,EAAAA,GAAAN,EAAA,GAAlDtF,EAAE6F,EAACN,EAAA,GAACvF,EAAE4C,EAAC2C,EAAA,GAA4CvF,EAAE8F,WAAWlF,KAAKJ,cAAcuF,kBAAkBhE,EAAEnC,KAAI4F,GAAAI,EAAAA,EAAAA,GAAoBhF,KAAKJ,cAAcgB,SAASwE,KAAI,GAAlDhG,EAAEiG,MAAKT,EAAA,GAACxF,EAAEkG,OAAMV,EAAA,GAAmC5E,KAAKuF,kBAAkBpE,GAAGnB,KAAKuE,YAAYiB,SAASrE,GAAGnB,KAAKqE,gBAAgBlD,CAAC,GAAC,CAAAnC,IAAA,YAAAe,MAAA,eAAA0F,GAAAC,EAAAA,EAAAA,IAAAC,EAAAA,EAAAA,KAAAC,MAAA,SAAAC,IAAA,OAAAF,EAAAA,EAAAA,KAAAG,MAAA,SAAAC,GAAA,cAAAA,EAAAC,KAAAD,EAAAE,MAAA,QAAmBjG,KAAKkG,UAAUlG,KAAKmG,iBAAiBnG,KAAKoG,WAAWpG,KAAKiE,WAAU,wBAAA8B,EAAAM,OAAA,GAAAR,EAAA,UAAC,yBAAAJ,EAAArD,MAAA,KAAAC,UAAA,EAAxF,IAAwF,CAAArD,IAAA,aAAAe,MAAA,WAAY,IAAAuG,EAAAC,EAAC,OAAiC,QAAjCD,EAAuB,QAAvBC,EAAOvG,KAAKuC,mBAAW,IAAAgE,OAAA,EAAhBA,EAAkBC,gBAAQ,IAAAF,GAAAA,CAAI,GAAC,CAAAtH,IAAA,YAAAe,MAAA,eAAA0G,GAAAf,EAAAA,EAAAA,IAAAC,EAAAA,EAAAA,KAAAC,MAAA,SAAAc,EAAgB5H,GAAC,IAAAqC,EAAAZ,EAAAxB,EAAA4H,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAA3H,EAAA4H,EAAA5E,UAAA,OAAAsD,EAAAA,EAAAA,KAAAG,MAAA,SAAAoB,GAAA,cAAAA,EAAAlB,KAAAkB,EAAAjB,MAAA,OAAqG,GAApG9E,EAAC8F,EAAAE,OAAA,QAAAC,IAAAH,EAAA,GAAAA,EAAA,GAAC,CAAC,EAAS1G,EAAE,iBAAiBP,KAAK0C,MAAM1C,KAAK0C,MAAM2E,aAAa,KAAatI,EAAuBoC,EAA9BmG,OAAMX,EAAwBxF,EAArBoG,gBAAgBX,OAAC,IAAAD,EAAC,EAACA,EAAQpG,EAAC,CAAA2G,EAAAjB,KAAA,eAAAiB,EAAAM,OAAA,SAAQxH,KAAKyH,YAAY3I,EAAEC,IAAE,OAAuB,OAAhB8H,EAAE,IAAIa,EAAAA,EAAE,EAAE,EAAE,EAAE,GAAER,EAAAlB,KAAA,EAAAkB,EAAAjB,KAAA,EAAiB1F,EAAEoH,0BAA0B7I,EAAEG,MAAMH,EAAEI,IAAIJ,EAAEK,IAAI0H,EAAE,CAACS,OAAOvI,IAAG,cAAAmI,EAAAjB,KAAA,GAASjG,KAAKyH,YAAYZ,EAAE9H,GAAE,QAA7B+H,EAACI,EAAAU,KAAAV,EAAAjB,KAAA,oBAAAiB,EAAAlB,KAAA,GAAAkB,EAAAW,GAAAX,EAAA,WAAyC9H,EAAAA,EAAAA,IAAC8H,EAAAW,IAAG,CAAAX,EAAAjB,KAAA,eAAAiB,EAAAW,GAAA,aAAYjB,EAAE,GAAC,CAAAM,EAAAjB,KAAA,SAAkD,KAA1C7G,EAAEY,KAAKJ,cAAckI,gBAAgBhJ,EAAE+D,KAAQ,CAAAqE,EAAAjB,KAAA,SAAkB,OAAV1F,EAAE,IAAImH,EAAAA,EAAEtI,GAAE8H,EAAAjB,KAAA,GAASjG,KAAKwD,UAAUjD,GAACwH,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GAAK5G,GAAC,IAACoG,gBAAgBX,EAAE,KAAG,QAAnD,OAAD7H,EAACmI,EAAAU,KAAAV,EAAAM,OAAA,UAA2DQ,EAAAA,EAAAA,GAAEhI,KAAKJ,cAAcb,EAAEwB,EAAEzB,IAAE,cAAAoI,EAAAW,GAAA,eAAAX,EAAAM,OAAA,UAAiBQ,EAAAA,EAAAA,GAAEhI,KAAKJ,cAAckH,EAAED,EAAE/H,IAAE,yBAAAoI,EAAAb,OAAA,GAAAK,EAAA,mBAAC,gBAAAuB,GAAA,OAAAxB,EAAArE,MAAA,KAAAC,UAAA,EAA7gB,IAA6gB,CAAArD,IAAA,YAAAe,MAAA,WAAY,IAAMjB,GAACqB,EAAAA,EAAAA,IAAAC,EAAAA,EAAAA,GAAA8B,EAAA7B,WAAA,kBAAAV,KAAA,MAAmB,OAAOb,EAAE,OAAOkB,KAAKmD,cAAcrE,CAAC,GAAC,CAAAE,IAAA,2BAAAe,MAAA,SAAyBjB,GAAE,IAAAoJ,EAAAC,EAAC,OAA0F,QAA1FD,EAA4C,QAA5CC,EAAOnI,KAAK0C,MAAME,YAAYwF,sBAAc,IAAAD,OAAA,EAArCA,EAAuCE,MAAM,SAAAlH,GAAC,IAAAmH,EAAA,OAAEzB,EAAAA,EAAAA,IAAY,QAAXyB,EAACnH,EAAEP,gBAAQ,IAAA0H,OAAA,EAAVA,EAAYC,iBAAiBzJ,EAAE,WAAE,IAAAoJ,GAAAA,CAAI,GAAC,CAAAlJ,IAAA,oBAAAe,MAAA,eAAAyI,GAAA9C,EAAAA,EAAAA,IAAAC,EAAAA,EAAAA,KAAAC,MAAA,SAAA6C,EAAwB3J,GAAC,IAAA4J,EAAAC,EAAA,YAAAhD,EAAAA,EAAAA,KAAAG,MAAA,SAAA8C,GAAA,cAAAA,EAAA5C,KAAA4C,EAAA3C,MAAA,UAAMjG,KAAKuC,YAAYhB,IAAIzC,EAAEE,IAAI6D,IAAG,CAAA+F,EAAA3C,KAAA,gBAAA2C,EAAA5C,KAAA,EAAA4C,EAAA3C,KAAA,EAAoBjG,KAAKuC,YAAYxB,KAAKjC,EAAEE,KAAI,OAApCmC,EAACyH,EAAAhB,KAAoC9I,EAAEgG,OAAO+D,OAAO1H,EAAErC,EAAEgG,OAAOO,MAAMrF,KAAKJ,cAAcgB,SAASwE,KAAK,GAAGtG,EAAEgG,OAAOQ,OAAOtF,KAAKJ,cAAcgB,SAASwE,KAAK,GAAGtG,EAAE2F,KAAK,UAAU,kBAAIkE,EAAKtE,eAAe,IAAEuE,EAAA3C,KAAA,gBAAA2C,EAAA5C,KAAA,EAAA4C,EAAAf,GAAAe,EAAA,UAAUxJ,EAAAA,EAAAA,IAACwJ,EAAAf,KAAK1G,EAAAA,EAAAA,UAAYnB,KAAK8I,eAAeC,MAAKH,EAAAf,IAAG,QAAC7H,KAAKqE,gBAAe,yBAAAuE,EAAAvC,OAAA,GAAAoC,EAAA,kBAAE,gBAAAO,GAAA,OAAAR,EAAApG,MAAA,KAAAC,UAAA,EAAjW,IAAiW,CAAArD,IAAA,cAAAe,MAAA,eAAAkJ,GAAAvD,EAAAA,EAAAA,IAAAC,EAAAA,EAAAA,KAAAC,MAAA,SAAAsD,EAAkBpK,EAAEqC,GAAC,OAAAwE,EAAAA,EAAAA,KAAAG,MAAA,SAAAqD,GAAA,cAAAA,EAAAnD,KAAAmD,EAAAlD,MAAA,cAAAkD,EAAA3B,OAAA,SAASxH,KAAK0C,MAAM0G,qBAAqBtK,EAAEG,MAAMH,EAAEI,IAAIJ,EAAEK,IAAI,CAACmI,OAAOnG,KAAG,wBAAAgI,EAAA9C,OAAA,GAAA6C,EAAA,UAAC,gBAAAG,EAAAC,GAAA,OAAAL,EAAA7G,MAAA,KAAAC,UAAA,EAA9F,IAA8F,CAAArD,IAAA,WAAAe,MAAA,WAAU,IAAAwJ,EAAA,KAACvJ,KAAKuC,YAAYiH,QAAQxJ,KAAKsC,cAAcmH,MAAMC,SAAS,SAAA5K,GAAI,GAAIA,EAAEgG,OAAO+D,OAAb,CAA2B,IAAM1H,EAAE,CAAC0B,GAAG/D,EAAEE,IAAI6D,GAAG8G,WAAU,EAAGC,QAAQL,EAAKhH,YAAYxB,KAAKjC,EAAEE,KAAK6K,MAAM,SAAA1I,GAAIrC,EAAEgG,OAAO+D,OAAO1H,CAAC,IAAI2I,OAAO,SAAA3I,IAAI/B,EAAAA,EAAAA,IAAE+B,KAAKrC,EAAEgG,OAAO+D,OAAO,KAAK,IAAIkB,SAAS,WAAKjL,EAAEkL,gBAAgB7I,EAAEwI,WAAU,CAAE,KAAKJ,EAAK/G,cAAcyH,IAAInL,EAAEqC,EAA9N,CAAgO,GAAG,GAAC,CAAAnC,IAAA,sCAAAe,MAAA,SAAoCjB,GAAG,IAAMqC,EAAEnB,KAAKkK,KAAK3B,iBAAiB,IAAIzJ,EAAEsJ,eAAe,OAAO,KAAK,IAAIhJ,EAAEN,EAAEsJ,eAAe+B,MAAM,SAAArL,GAAC,IAAAsL,EAAA,OAAEvD,EAAAA,EAAAA,IAAY,QAAXuD,EAACtL,EAAE8B,gBAAQ,IAAAwJ,OAAA,EAAVA,EAAY7B,iBAAiBpH,EAAE,IAAG,OAAO/B,GAAG+B,EAAEkJ,gBAAgBjL,EAAEN,EAAEsJ,eAAe+B,MAAM,SAAArL,GAAC,IAAAwL,EAAAC,EAAA,OAAEvI,EAAEwI,SAA0C,QAAlCF,EAAW,QAAXC,EAACzL,EAAE8B,gBAAQ,IAAA2J,OAAA,EAAVA,EAAYhC,iBAAiBkC,YAAI,IAAAH,EAAAA,GAAG,EAAE,KAAIlL,CAAC,KAAC8C,CAAA,CAAr+G,EAAewI,EAAAA,EAAAA,IAAE5D,EAAAA,EAAAA,IAAE6D,EAAAA,EAAAA,GAAEC,EAAAA,OAAk9G9L,EAAAA,EAAAA,GAAE,EAACC,EAAAA,EAAAA,OAAKmD,EAAE7B,UAAU,mBAAc,IAAQvB,EAAAA,EAAAA,GAAE,EAACC,EAAAA,EAAAA,IAAE,CAAC8L,UAAS,KAAM3I,EAAE7B,UAAU,gBAAgB,MAAyD,IAAMyK,EAAzD5I,GAAEpD,EAAAA,EAAAA,GAAE,EAAC8H,EAAAA,EAAAA,GAAE,yCAAyC1E,E,8LCAvrI9C,EAAE,SAAAA,GAAI,IAAI4I,EAAC,SAAAjB,IAAAzH,EAAAA,EAAAA,GAAA0I,EAAAjB,GAAA,IAAAxH,GAAAC,EAAAA,EAAAA,GAAAwI,GAAA,SAAAA,IAAA,OAAAtI,EAAAA,EAAAA,GAAA,KAAAsI,GAAAzI,EAAA6C,MAAA,KAAAC,UAAA,CAAuM,OAAvMxC,EAAAA,EAAAA,GAAAmI,EAAA,EAAAhJ,IAAA,aAAAe,MAAiB,WAAY,IAAAN,EAAA,KAACO,KAAK+K,QAAQC,KAAIlE,EAAAA,EAAAA,KAAG,kBAAIrH,EAAKiD,KAAK,GAAE,WAAW,SAAA3D,GAAIU,EAAKwL,UAAUlM,EAAEmM,aAAapB,OAAO,SAAA/K,IAAIwB,EAAAA,EAAAA,IAAExB,IAAID,EAAAA,EAAAA,UAAYW,EAAKqJ,eAAeC,MAAMhK,EAAE,GAAG,IAAI,uBAAuB,KAACiJ,CAAA,CAAvM,CAAe5I,GAA0L,OAAOL,EAAAA,EAAAA,GAAE,EAACoC,EAAAA,EAAAA,OAAK6G,EAAE3H,UAAU,aAAQ,GAAQ2H,GAAEjJ,EAAAA,EAAAA,GAAE,EAAC6H,EAAAA,EAAAA,GAAE,4CAA4CoB,EAAI,C","sources":["../node_modules/@arcgis/core/views/2d/engine/webgl/TileContainer.js","../node_modules/@arcgis/core/views/2d/layers/WMTSLayerView2D.js","../node_modules/@arcgis/core/views/layers/RefreshableLayerView.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport has from\"../../../../core/has.js\";import{WGLDrawPhase as e}from\"./enums.js\";import r from\"./WGLContainer.js\";import s from\"./brushes/WGLBrushInfo.js\";import t from\"./brushes/WGLBrushStencil.js\";const n=(e,r)=>e.key.level-r.key.level!=0?e.key.level-r.key.level:e.key.row-r.key.row!=0?e.key.row-r.key.row:e.key.col-r.key.col;class i extends r{constructor(e){super(),this._tileInfoView=e}get requiresDedicatedFBO(){return!1}renderChildren(e){this.sortChildren(n),this.setStencilReference(e),super.renderChildren(e)}createRenderParams(e){const{state:r}=e,s=super.createRenderParams(e);return s.requiredLevel=this._tileInfoView.getClosestInfoForScale(r.scale).level,s.displayLevel=this._tileInfoView.tileInfo.scaleToZoom(r.scale),s}prepareRenderPasses(r){const n=super.prepareRenderPasses(r);return n.push(r.registerRenderPass({name:\"stencil\",brushes:[t],drawPhase:e.DEBUG|e.MAP|e.HIGHLIGHT,target:()=>this.getStencilTarget()})),has(\"esri-tiles-debug\")&&n.push(r.registerRenderPass({name:\"tileInfo\",brushes:[s],drawPhase:e.DEBUG,target:()=>this.children})),n}getStencilTarget(){return this.children}setStencilReference(e){let r=1;for(const s of this.children)s.stencilRef=r++}}export{i as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import t from\"../../../core/Logger.js\";import{isAbortError as i}from\"../../../core/promiseUtils.js\";import{watch as s}from\"../../../core/reactiveUtils.js\";import{property as r}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/accessorSupport/ensureType.js\";import\"../../../core/arrayUtils.js\";import{subclass as a}from\"../../../core/accessorSupport/decorators/subclass.js\";import{equals as l}from\"../../../geometry/support/spatialReferenceUtils.js\";import{BitmapTileLayerView2D as o}from\"./BitmapTileLayerView2D.js\";import{LayerView2DMixin as h}from\"./LayerView2D.js\";import{resampleImage as c}from\"./support/imageUtils.js\";import n from\"../tiling/TileInfoView.js\";import u from\"../tiling/TileKey.js\";import p from\"../tiling/TileQueue.js\";import f from\"../tiling/TileStrategy.js\";import m from\"../../layers/LayerView.js\";import d from\"../../layers/RefreshableLayerView.js\";const y=[102113,102100,3857,3785,900913],_=[0,0];let w=class extends(d(o(h(m)))){constructor(){super(...arguments),this._tileStrategy=null,this._fetchQueue=null,this._tileRequests=new Map,this.layer=null}get tileMatrixSet(){const e=this._getTileMatrixSetBySpatialReference(this.layer.activeLayer);return e?(e.id!==this.layer.activeLayer.tileMatrixSetId&&(this.layer.activeLayer.tileMatrixSetId=e.id),e):null}update(e){this._fetchQueue.pause(),this._fetchQueue.state=e.state,this._tileStrategy.update(e),this._fetchQueue.resume()}attach(){const e=this.tileMatrixSet?.tileInfo;e&&(this._tileInfoView=new n(e),this._fetchQueue=new p({tileInfoView:this._tileInfoView,concurrency:16,process:(e,t)=>this.fetchTile(e,t)}),this._tileStrategy=new f({cachePolicy:\"keep\",resampling:!0,acquireTile:e=>this.acquireTile(e),releaseTile:e=>this.releaseTile(e),tileInfoView:this._tileInfoView}),this.addAttachHandles(s((()=>[this.layer?.activeLayer?.styleId,this.tileMatrixSet]),(()=>this._refresh()))),super.attach())}detach(){super.detach(),this._tileStrategy?.destroy(),this._fetchQueue?.destroy(),this._fetchQueue=this._tileStrategy=this._tileInfoView=null}moveStart(){this.requestUpdate()}viewChange(){this.requestUpdate()}moveEnd(){this.requestUpdate()}releaseTile(e){this._fetchQueue.abort(e.key.id),this._bitmapView.removeChild(e),e.once(\"detach\",(()=>e.destroy())),this.requestUpdate()}acquireTile(e){const t=this._bitmapView.createTile(e),i=t.bitmap;return[i.x,i.y]=this._tileInfoView.getTileCoords(_,t.key),i.resolution=this._tileInfoView.getTileResolution(t.key),[i.width,i.height]=this._tileInfoView.tileInfo.size,this._enqueueTileFetch(t),this._bitmapView.addChild(t),this.requestUpdate(),t}async doRefresh(){!this.attached||this.updateRequested||this.suspended||this._refresh()}isUpdating(){return this._fetchQueue?.updating??!1}async fetchTile(e,t={}){const s=\"tilemapCache\"in this.layer?this.layer.tilemapCache:null,{signal:r,resamplingLevel:a=0}=t;if(!s)return this._fetchImage(e,r);const l=new u(0,0,0,0);let o;try{await s.fetchAvailabilityUpsample(e.level,e.row,e.col,l,{signal:r}),o=await this._fetchImage(l,r)}catch(h){if(i(h))throw h;if(a<3){const i=this._tileInfoView.getTileParentId(e.id);if(i){const s=new u(i),r=await this.fetchTile(s,{...t,resamplingLevel:a+1});return c(this._tileInfoView,r,s,e)}}throw h}return c(this._tileInfoView,o,l,e)}canResume(){const e=super.canResume();return e?null!==this.tileMatrixSet:e}supportsSpatialReference(e){return this.layer.activeLayer.tileMatrixSets?.some((t=>l(t.tileInfo?.spatialReference,e)))??!1}async _enqueueTileFetch(e){if(!this._fetchQueue.has(e.key.id)){try{const t=await this._fetchQueue.push(e.key);e.bitmap.source=t,e.bitmap.width=this._tileInfoView.tileInfo.size[0],e.bitmap.height=this._tileInfoView.tileInfo.size[1],e.once(\"attach\",(()=>this.requestUpdate()))}catch(s){i(s)||t.getLogger(this.declaredClass).error(s)}this.requestUpdate()}}async _fetchImage(e,t){return this.layer.fetchImageBitmapTile(e.level,e.row,e.col,{signal:t})}_refresh(){this._fetchQueue.reset(),this._tileStrategy.tiles.forEach((e=>{if(!e.bitmap.source)return;const t={id:e.key.id,fulfilled:!1,promise:this._fetchQueue.push(e.key).then((t=>{e.bitmap.source=t})).catch((t=>{i(t)||(e.bitmap.source=null)})).finally((()=>{e.requestRender(),t.fulfilled=!0}))};this._tileRequests.set(e,t)}))}_getTileMatrixSetBySpatialReference(e){const t=this.view.spatialReference;if(!e.tileMatrixSets)return null;let i=e.tileMatrixSets.find((e=>l(e.tileInfo?.spatialReference,t)));return!i&&t.isWebMercator&&(i=e.tileMatrixSets.find((e=>y.includes(e.tileInfo?.spatialReference.wkid??-1)))),i}};e([r()],w.prototype,\"_fetchQueue\",void 0),e([r({readOnly:!0})],w.prototype,\"tileMatrixSet\",null),w=e([a(\"esri.views.2d.layers.WMTSLayerView2D\")],w);const g=w;export{g as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport{_ as r}from\"../../chunks/tslib.es6.js\";import e from\"../../core/Logger.js\";import{isAbortError as s}from\"../../core/promiseUtils.js\";import{on as o}from\"../../core/reactiveUtils.js\";import{property as t}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/accessorSupport/ensureType.js\";import\"../../core/arrayUtils.js\";import{subclass as a}from\"../../core/accessorSupport/decorators/subclass.js\";const i=i=>{let c=class extends i{initialize(){this.handles.add(o((()=>this.layer),\"refresh\",(r=>{this.doRefresh(r.dataChanged).catch((r=>{s(r)||e.getLogger(this.declaredClass).error(r)}))})),\"RefreshableLayerView\")}};return r([t()],c.prototype,\"layer\",void 0),c=r([a(\"esri.layers.mixins.RefreshableLayerView\")],c),c};export{i as default};\n"],"names":["n","e","r","key","level","row","col","i","_r","_inherits","_super","_createSuper","_this","_classCallCheck","call","_tileInfoView","_createClass","get","value","this","sortChildren","setStencilReference","_get","_getPrototypeOf","prototype","state","s","requiredLevel","getClosestInfoForScale","scale","displayLevel","tileInfo","scaleToZoom","_this2","push","registerRenderPass","name","brushes","t","drawPhase","target","getStencilTarget","has","children","_step","_iterator","_createForOfIteratorHelper","done","stencilRef","err","f","y","_","w","_d","apply","arguments","_tileStrategy","_fetchQueue","_tileRequests","Map","layer","_getTileMatrixSetBySpatialReference","activeLayer","id","tileMatrixSetId","pause","update","resume","_this$tileMatrixSet","tileMatrixSet","p","tileInfoView","concurrency","process","fetchTile","cachePolicy","resampling","acquireTile","releaseTile","addAttachHandles","_this2$layer","_this2$layer$activeLa","styleId","_refresh","_this$_tileStrategy","_this$_fetchQueue","destroy","requestUpdate","abort","_bitmapView","removeChild","once","_this$_tileInfoView$g","_this$_tileInfoView$g2","_this$_tileInfoView$t","createTile","bitmap","getTileCoords","_slicedToArray","x","resolution","getTileResolution","size","width","height","_enqueueTileFetch","addChild","_doRefresh","_asyncToGenerator","_regeneratorRuntime","mark","_callee","wrap","_context","prev","next","attached","updateRequested","suspended","stop","_this$_fetchQueue$upd","_this$_fetchQueue2","updating","_fetchTile","_callee2","_t$resamplingLevel","a","l","o","_i","_s","_args2","_context2","length","undefined","tilemapCache","signal","resamplingLevel","abrupt","_fetchImage","u","fetchAvailabilityUpsample","sent","t0","getTileParentId","_objectSpread","c","_x","_this$layer$activeLay","_this$layer$activeLay2","tileMatrixSets","some","_t$tileInfo","spatialReference","_enqueueTileFetch2","_callee3","_t","_this3","_context3","source","declaredClass","error","_x2","_fetchImage2","_callee4","_context4","fetchImageBitmapTile","_x3","_x4","_this4","reset","tiles","forEach","fulfilled","promise","then","catch","finally","requestRender","set","view","find","_e$tileInfo","isWebMercator","_e$tileInfo$spatialRe","_e$tileInfo2","includes","wkid","d","h","m","readOnly","g","handles","add","doRefresh","dataChanged"],"sourceRoot":""}