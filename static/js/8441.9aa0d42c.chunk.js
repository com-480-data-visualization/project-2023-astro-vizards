"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[8441],{59877:function(e,t,n){n.d(t,{p:function(){return p}});var a=n(29439),r=n(37762),i=n(74165),u=n(15861),c=n(15671),o=n(43144),s=(n(93169),n(16054)),f=n(77427),h=n(92026),l=n(66978),d=n(68860),v=n(88152);function p(){var e=arguments.length>1?arguments[1]:void 0;if(arguments.length>0&&void 0!==arguments[0]&&arguments[0]){var t=e.elevationInfo,n=e.alignPointsInFeatures,a=e.spatialReference;return new g(t,n,a)}return new y}var y=function(){function e(){(0,c.Z)(this,e)}return(0,o.Z)(e,[{key:"alignCandidates",value:function(){var e=(0,u.Z)((0,i.Z)().mark((function e(t,n){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t);case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"notifyElevationSourceChange",value:function(){}}]),e}(),g=function(){function e(t,n,a){(0,c.Z)(this,e),this._elevationInfo=t,this._alignPointsInFeatures=n,this.spatialReference=a,this._alignmentsCache=new s.Z(1024),this._cacheVersion=0,this._metersPerVerticalUnit=(0,d._R)(a)}return(0,o.Z)(e,[{key:"alignCandidates",value:function(){var e=(0,u.Z)((0,i.Z)().mark((function e(t,n){var a;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=this._elevationInfo,e.abrupt("return",(0,h.pC)(a)&&"absolute-height"===a.mode&&!a.featureExpressionInfo?(this._alignAbsoluteElevationCandidates(t,a),t):this._alignComputedElevationCandidates(t,n));case 2:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"notifyElevationSourceChange",value:function(){this._alignmentsCache.clear(),this._cacheVersion++}},{key:"_alignAbsoluteElevationCandidates",value:function(e,t){var n=t.offset,a=t.unit;if(!(0,h.Wi)(n)){var i,u=n*((0,v.Z7)(null!==a&&void 0!==a?a:"meters")/this._metersPerVerticalUnit),c=(0,r.Z)(e);try{for(c.s();!(i=c.n()).done;){var o=i.value;switch(o.type){case"edge":o.start.z+=u,o.end.z+=u;continue;case"vertex":o.target.z+=u;continue}}}catch(s){c.e(s)}finally{c.f()}}}},{key:"_alignComputedElevationCandidates",value:function(){var e=(0,u.Z)((0,i.Z)().mark((function e(t,n){var u,c,o,s,h,d,v,p,y,g,Z,_,k,x,b,w,z;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:u=new Map,c=(0,r.Z)(t);try{for(c.s();!(o=c.n()).done;)s=o.value,(0,f.s1)(u,s.objectId,C).push(s)}catch(i){c.e(i)}finally{c.f()}return h=this._prepareQuery(u),d=(0,a.Z)(h,3),v=d[0],p=d[1],y=d[2],e.next=10,this._alignPointsInFeatures(v,n);case 10:if(g=e.sent,(0,l.k_)(n),y===this._cacheVersion){e.next=14;break}return e.abrupt("return",this._alignComputedElevationCandidates(t,n));case 14:this._applyCacheAndResponse(v,g,p),Z=g.drapedObjectIds,_=g.failedObjectIds,k=[],x=(0,r.Z)(t);try{for(x.s();!(b=x.n()).done;)w=b.value,z=w.objectId,Z.has(z)&&"edge"===w.type&&(w.draped=!0),_.has(z)||k.push(w)}catch(i){x.e(i)}finally{x.f()}return e.abrupt("return",k);case 19:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_prepareQuery",value:function(e){var t,n=[],i=[],u=(0,r.Z)(e);try{for(u.s();!(t=u.n()).done;){var c,o=(0,a.Z)(t.value,2),s=o[0],f=o[1],h=[],l=(0,r.Z)(f);try{for(l.s();!(c=l.n()).done;){var d=c.value;this._addToQueriesOrCachedResult(s,d.target,h,i),"edge"===d.type&&(this._addToQueriesOrCachedResult(s,d.start,h,i),this._addToQueriesOrCachedResult(s,d.end,h,i))}}catch(v){l.e(v)}finally{l.f()}0!==h.length&&n.push({objectId:s,points:h})}}catch(v){u.e(v)}finally{u.f()}return[n,i,this._cacheVersion]}},{key:"_addToQueriesOrCachedResult",value:function(e,t,n,a){var r=_(e,t),i=this._alignmentsCache.get(r);(0,h.pC)(i)?a.push(new Z(t,i)):n.push(t)}},{key:"_applyCacheAndResponse",value:function(e,t,n){var a,i=t.elevations,u=t.drapedObjectIds,c=t.failedObjectIds,o=(0,r.Z)(n);try{for(o.s();!(a=o.n()).done;){a.value.apply()}}catch(b){o.e(b)}finally{o.f()}var s,f=0,h=this._alignmentsCache,l=(0,r.Z)(e);try{for(l.s();!(s=l.n()).done;){var d=s.value,v=d.objectId,p=d.points;if(c.has(v))f+=p.length;else{var y,g=!u.has(v),Z=(0,r.Z)(p);try{for(Z.s();!(y=Z.n()).done;){var C=y.value,k=_(v,C),x=i[f++];C.z=x,g&&h.put(k,x,1)}}catch(b){Z.e(b)}finally{Z.f()}}}}catch(b){l.e(b)}finally{l.f()}}}]),e}(),Z=function(){function e(t,n){(0,c.Z)(this,e),this.point=t,this.z=n}return(0,o.Z)(e,[{key:"apply",value:function(){this.point.z=this.z}}]),e}();function _(e,t){var n=t.x,a=t.y,r=t.z;return"".concat(e,"-").concat(n,"-").concat(a,"-").concat(null!==r&&void 0!==r?r:0,"}")}function C(){return[]}},53580:function(e,t,n){n.d(t,{c:function(){return s}});var a=n(37762),r=n(15671),i=n(43144),u=(n(93169),function(){function e(){(0,r.Z)(this,e)}return(0,i.Z)(e,[{key:"filter",value:function(e,t){return t}},{key:"notifyElevationSourceChange",value:function(){}}]),e}()),c=function(){function e(){(0,r.Z)(this,e)}return(0,i.Z)(e,[{key:"filter",value:function(e,t){var n=e.point,a=e.distance;if(null==n.z)return t;if(0===t.length)return t;var r=function(e){return"number"==typeof e?{x:e,y:e,z:e}:e}(a),i=this._updateCandidatesTo3D(t,n,r).filter(o);return i.sort(l),i}},{key:"_updateCandidatesTo3D",value:function(e,t,n){var r,i=(0,a.Z)(e);try{for(i.s();!(r=i.n()).done;){var u=r.value;switch(u.type){case"edge":f(u,t,n);continue;case"vertex":h(u,t,n);continue}}}catch(c){i.e(c)}finally{i.f()}return e}}]),e}();function o(e){return e.distance<=1}function s(){return arguments.length>0&&void 0!==arguments[0]&&arguments[0]?new c:new u}function f(e,t,n){var a=n.x,r=n.y,i=n.z,u=e.start,c=e.end,o=e.target;e.draped||function(e,t,n,a){var r=a.x-n.x,i=a.y-n.y,u=a.z-n.z,c=r*r+i*i+u*u,o=(t.x-n.x)*r+(t.y-n.y)*i+u*(t.z-n.z),s=Math.min(1,Math.max(0,o/c)),f=n.x+r*s,h=n.y+i*s,l=n.z+u*s;e.x=f,e.y=h,e.z=l}(o,t,u,c);var s=(t.x-o.x)/a,f=(t.y-o.y)/r,h=(t.z-o.z)/i;e.distance=Math.sqrt(s*s+f*f+h*h)}function h(e,t,n){var a=n.x,r=n.y,i=n.z,u=e.target,c=(t.x-u.x)/a,o=(t.y-u.y)/r,s=(t.z-u.z)/i,f=Math.sqrt(c*c+o*o+s*s);e.distance=f}function l(e,t){return e.distance-t.distance}},48817:function(e,t,n){n.d(t,{k:function(){return l}});var a=n(37762),r=n(74165),i=n(15861),u=n(15671),c=n(43144),o=(n(93169),n(84652)),s=n(16054),f=n(66978),h=n(643);function l(){return arguments.length>0&&void 0!==arguments[0]&&arguments[0]?new v(arguments.length>1?arguments[1]:void 0):new d}var d=function(){function e(){(0,u.Z)(this,e)}return(0,c.Z)(e,[{key:"fetch",value:function(){var e=(0,i.Z)((0,r.Z)().mark((function e(){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",[]);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"notifySymbologyChange",value:function(){}}]),e}(),v=function(){function e(t){(0,u.Z)(this,e),this._getSymbologyCandidates=t,this._candidatesCache=new s.Z(1024),this._cacheVersion=0}return(0,c.Z)(e,[{key:"fetch",value:function(){var e=(0,i.Z)((0,r.Z)().mark((function e(t,n){var i,u,c,s,h,l,d,v,y,g,Z,_,C,k,x,b,w,z,m,I,j;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==t.length){e.next=2;break}return e.abrupt("return",[]);case 2:i=[],u=[],c=this._candidatesCache,s=(0,a.Z)(t);try{for(s.s();!(h=s.n()).done;)if(l=h.value,d=p(l),v=c.get(d)){y=(0,a.Z)(v);try{for(y.s();!(g=y.n()).done;)Z=g.value,u.push((0,o.d9)(Z))}catch(r){y.e(r)}finally{y.f()}}else i.push(l),c.put(d,[],1)}catch(r){s.e(r)}finally{s.f()}if(0!==i.length){e.next=7;break}return e.abrupt("return",u);case 7:return _=this._cacheVersion,e.next=10,this._getSymbologyCandidates(i,n);case 10:if(C=e.sent,k=C.candidates,x=C.sourceCandidateIndices,(0,f.k_)(n),_===this._cacheVersion){e.next=16;break}return e.abrupt("return",this.fetch(t,n));case 16:for(b=[],w=k.length,z=0;z<w;++z)m=k[z],I=p(i[x[z]]),(j=c.get(I)).push(m),c.put(I,j,j.length),b.push((0,o.d9)(m));return e.abrupt("return",u.concat(b));case 19:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"notifySymbologyChange",value:function(){this._candidatesCache.clear(),this._cacheVersion++}}]),e}();function p(e){switch(e.type){case"vertex":var t,n=e.objectId,a=e.target,r="".concat(n,"-vertex-").concat(a.x,"-").concat(a.y,"-").concat(null!==(t=a.z)&&void 0!==t?t:0);return(0,h.hP)(r).toString();case"edge":var i,u,c=e.objectId,o=e.start,s=e.end,f="".concat(c,"-edge-").concat(o.x,"-").concat(o.y,"-").concat(null!==(i=o.z)&&void 0!==i?i:0,"-to-").concat(s.x,"-").concat(s.y,"-").concat(null!==(u=s.z)&&void 0!==u?u:0);return(0,h.hP)(f).toString();default:return""}}}}]);
//# sourceMappingURL=8441.9aa0d42c.chunk.js.map