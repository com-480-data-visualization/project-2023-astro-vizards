"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[6370],{32500:function(e,t,n){n.d(t,{I:function(){return A},b:function(){return w}});var i,a,r,o=n(30168),s=n(92026),c=n(6394),l=n(37081),u=n(33280),h=n(94951),d=n(15226),v=n(26461),f=n(116),p=n(41012),_=n(82999),g=n(58406),y=n(98634),b=n(64201),m=n(19253),S=n(25920),T=n(4760);function w(e){var t=new b.kG,n=t.vertex,w=t.fragment;return(0,p.Sv)(n,e),t.include(h.w,e),t.attributes.add(T.T.POSITION,"vec3"),t.attributes.add(T.T.UV0,"vec2"),t.varyings.add("vpos","vec3"),e.hasMultipassTerrain&&t.varyings.add("depth","float"),n.uniforms.add(new _.A("textureCoordinateScaleFactor",(function(e){return(0,s.pC)(e.texture)&&(0,s.pC)(e.texture.descriptor.textureCoordinateScaleFactor)?e.texture.descriptor.textureCoordinateScaleFactor:c.O}))),n.code.add((0,y.H)(i||(i=(0,o.Z)(["\n    void main(void) {\n      vpos = position;\n      ","\n      vTexCoord = uv0 * textureCoordinateScaleFactor;\n      gl_Position = transformPosition(proj, view, vpos);\n    }\n  "])),e.hasMultipassTerrain?"depth = (view * vec4(vpos, 1.0)).z;":"")),t.include(u.f5,e),t.include(d.l,e),w.uniforms.add([new m.A("tex",(function(e){return e.texture})),new g.p("opacity",(function(e){return e.opacity}))]),t.varyings.add("vTexCoord","vec2"),e.output===l.H.Alpha?w.code.add((0,y.H)(a||(a=(0,o.Z)(["\n    void main() {\n      discardBySlice(vpos);\n      ","\n\n      float alpha = texture2D(tex, vTexCoord).a * opacity;\n      if (alpha  < ",") {\n        discard;\n      }\n\n      gl_FragColor = vec4(alpha);\n    }\n    "])),e.hasMultipassTerrain?"terrainDepthTest(gl_FragCoord, depth);":"",y.H.float(v.F))):(w.include(f.Y),w.code.add((0,y.H)(r||(r=(0,o.Z)(["\n    void main() {\n      discardBySlice(vpos);\n      ","\n      gl_FragColor = texture2D(tex, vTexCoord) * opacity;\n\n      if (gl_FragColor.a < ",") {\n        discard;\n      }\n\n      gl_FragColor = highlightSlice(gl_FragColor, vpos);\n      ","\n    }\n    "])),e.hasMultipassTerrain?"terrainDepthTest(gl_FragCoord, depth);":"",y.H.float(v.F),e.transparencyPassType===S.A.Color?"gl_FragColor = premultiplyAlpha(gl_FragColor);":""))),t}var A=Object.freeze(Object.defineProperty({__proto__:null,build:w},Symbol.toStringTag,{value:"Module"}))},72511:function(e,t,n){n.d(t,{S:function(){return M},b:function(){return P}});var i,a,r,o,s,c,l,u,h,d,v=n(30168),f=n(67077),p=n(43505),_=n(37081),g=n(33280),y=n(94951),b=n(15226),m=n(26461),S=n(116),T=n(41012),w=n(49450),A=n(95276),E=n(98634),k=n(64201),O=n(25920),C=n(4760);function P(e){var t=new k.kG,n=e.hasMultipassTerrain&&(e.output===_.H.Color||e.output===_.H.Alpha);t.include(y.w,e),t.include(p.A,e),t.include(g.f5,e);var f=t.vertex,P=t.fragment;return P.include(S.Y),(0,T.Sv)(f,e),P.uniforms.add(new A.N("uColor",(function(e){return e.color}))),t.attributes.add(C.T.POSITION,"vec3"),t.varyings.add("vWorldPosition","vec3"),n&&t.varyings.add("depth","float"),e.screenSizeEnabled&&t.attributes.add(C.T.OFFSET,"vec3"),e.shadingEnabled&&((0,T._8)(f),t.attributes.add(C.T.NORMAL,"vec3"),t.varyings.add("vViewNormal","vec3")),f.code.add((0,E.H)(i||(i=(0,v.Z)(["\n    void main(void) {\n      vWorldPosition = ",";\n  "])),e.screenSizeEnabled?"screenSizeScaling(offset, position)":"position")),e.shadingEnabled&&f.code.add((0,E.H)(a||(a=(0,v.Z)(["vec3 worldNormal = normal;\nvViewNormal = (viewNormal * vec4(worldNormal, 1)).xyz;"])))),f.code.add((0,E.H)(r||(r=(0,v.Z)(["\n    ","\n    gl_Position = transformPosition(proj, view, vWorldPosition);\n  }\n  "])),n?"depth = (view * vec4(vWorldPosition, 1.0)).z;":"")),n&&t.include(b.l,e),P.code.add((0,E.H)(o||(o=(0,v.Z)(["\n    void main() {\n      discardBySlice(vWorldPosition);\n      ","\n    "])),n?"terrainDepthTest(gl_FragCoord, depth);":"")),e.shadingEnabled?(P.uniforms.add(new w.J("shadingDirection",(function(e){return e.shadingDirection}))),P.uniforms.add(new A.N("shadedColor",(function(e){return R(e.shadingTint,e.color)}))),P.code.add((0,E.H)(s||(s=(0,v.Z)(["vec3 viewNormalNorm = normalize(vViewNormal);\nfloat shadingFactor = 1.0 - clamp(-dot(viewNormalNorm, shadingDirection), 0.0, 1.0);\nvec4 finalColor = mix(uColor, shadedColor, shadingFactor);"]))))):P.code.add((0,E.H)(c||(c=(0,v.Z)(["vec4 finalColor = uColor;"])))),P.code.add((0,E.H)(l||(l=(0,v.Z)(["\n      ","\n      if (finalColor.a < ",") {\n        discard;\n      }\n      ","\n\n      ","\n    }\n    "])),e.output===_.H.ObjectAndLayerIdColor?(0,E.H)(u||(u=(0,v.Z)(["finalColor.a = 1.0;"]))):"",E.H.float(m.b),e.output===_.H.Alpha?(0,E.H)(h||(h=(0,v.Z)(["gl_FragColor = vec4(finalColor.a);"]))):"",e.output===_.H.Color?(0,E.H)(d||(d=(0,v.Z)(["gl_FragColor = highlightSlice(finalColor, vWorldPosition); ",""])),e.transparencyPassType===O.A.Color?"gl_FragColor = premultiplyAlpha(gl_FragColor);":""):"")),t}function R(e,t){var n=1-e[3],i=e[3]+t[3]*n;return 0===i?(L[3]=i,L):(L[0]=(e[0]*e[3]+t[0]*t[3]*n)/i,L[1]=(e[1]*e[3]+t[1]*t[3]*n)/i,L[2]=(e[2]*e[3]+t[2]*t[3]*n)/i,L[3]=t[3],L)}var L=(0,f.c)(),M=Object.freeze(Object.defineProperty({__proto__:null,build:P},Symbol.toStringTag,{value:"Module"}))},35284:function(e,t,n){n.d(t,{Z:function(){return j}});var i=n(37762),a=n(15671),r=n(43144),o=(n(59486),n(41644)),s=n(91505),c=n(16889),l=n(92026),u=n(17842),h=n(23879),d=n(22753),v=n(11873),f=n(14226),p=n(81949),_=n(88396),g=n(11186),y=n(71353),b=n(83448),m=n(79803),S=n(65156),T=n(85981),w=n(55652),A=n(40885),E=n(51378),k=n(37818),O=n(77648),C=n(81703),P=n(86755),R=n(66327),L=n(78485),M=n(97882),F=n(99034),Z=n(585),j=function(){function e(t){var n;for(var i in(0,a.Z)(this,e),this.metadata=void 0,this._camera=new P.V,this._elevation={offset:0,override:null},this.collisionType={type:"point"},this.collisionPriority=0,this._renderObjects=new Array,this.autoScaleRenderObjects=!0,this._available=!0,this._noDisplayCount=0,this._radius=10,this._worldSized=!1,this.focusMultiplier=2,this.touchMultiplier=2.5,this.worldOriented=!1,this._modelTransform=(0,p.c)(),this._worldFrame=null,this._renderLocation=(0,y.c)(),this._renderLocationDirty=!0,this._location=new Z.Z({x:0,y:0,z:0}),this._elevationAlignedLocation=new Z.Z,this._elevationAlignedLocationDirty=!0,this.interactive=!0,this.selectable=!1,this.grabbable=!0,this.cursor=null,this.grabCursor=null,this._grabbing=!1,this.dragging=!1,this._hovering=!1,this._selected=!1,this._state=F.jg.None,this._focused=!1,this.events=new s.Z.EventEmitter,this._screenLocation={screenPointArray:(0,u.s1)(),renderScreenPointArray:(0,u.J$)(),pixelSize:0},this._screenLocationDirty=!0,this._engineResourcesAddedToStage=!1,this._attached=!1,this._location.spatialReference=t.view.spatialReference,t)this[i]=t[i];var r=null===(n=this.view.state)||void 0===n?void 0:n.camera;r&&this._camera.copyFrom(r)}return(0,r.Z)(e,[{key:"destroy",value:function(){this._removeResourcesFromStage(),this._engineResources=null,this.view=null,this._camera=null}},{key:"_stage",get:function(){var e;return null===(e=this.view)||void 0===e?void 0:e._stage}},{key:"elevationInfo",get:function(){return this._elevationInfo},set:function(e){this._elevationInfo=e,this._elevationAlignedLocationDirty=!0,this._renderLocationDirty=!0,this._updateEngineObject()}},{key:"renderObjects",get:function(){return this._renderObjects},set:function(e){this._removeResourcesFromStage(),this._engineResources=null,this._renderObjects=e.slice(),this._updateEngineObject()}},{key:"available",get:function(){return this._available},set:function(e){e!==this._available&&(this._available=e,this._updateEngineObject())}},{key:"disableDisplay",value:function(){var e=this;return this._noDisplayCount++,1===this._noDisplayCount&&this._updateEngineObject(),{remove:(0,h.IH)((function(){e._noDisplayCount--,0===e._noDisplayCount&&e._updateEngineObject()}))}}},{key:"radius",get:function(){return this._radius},set:function(e){e!==this._radius&&(this._radius=e,this._updateEngineObject())}},{key:"worldSized",get:function(){return this._worldSized},set:function(e){e!==this._worldSized&&(this._worldSized=e,this._updateEngineObject())}},{key:"modelTransform",get:function(){return this._modelTransform},set:function(e){D(e)&&(this._screenLocationDirty=!0),(0,f.c)(this._modelTransform,e),this._updateEngineObject()}},{key:"renderLocation",get:function(){return this._renderLocationDirty&&(this._renderLocationDirty=!1,this.view.renderCoordsHelper.toRenderCoords(this.elevationAlignedLocation,this._renderLocation),this.worldOriented?(this._worldFrame||(this._worldFrame=(0,p.c)()),function(e,t,n){switch(e.viewingMode){case"local":return(0,f.i)(n),!0;case"global":var i=(0,b.Iu)(e.renderCoordsHelper.spatialReference);(0,m.PR)(t,0,U,0,i.radius),(0,m.yH)((0,c.Vl)(U[0]),(0,c.Vl)(U[1]),n)}}(this.view,this._renderLocation,this._worldFrame)):this._worldFrame&&(this._worldFrame=null)),this._renderLocation},set:function(e){this.view.renderCoordsHelper.fromRenderCoords(e,this._location),this.elevationAlignedLocation=this._location}},{key:"location",get:function(){return this._location},set:function(e){(0,k.WG)(e,this._location),this._notifyLocationChanged()}},{key:"_notifyLocationChanged",value:function(){this._renderLocationDirty=!0,this._screenLocationDirty=!0,this._elevationAlignedLocationDirty=!0,this._updateEngineObject(),this.events.emit("location-update",{location:this._location})}},{key:"elevationAlignedLocation",get:function(){return this._elevationAlignedLocationDirty?(this._evaluateElevationAlignment(),this._updateElevationAlignedLocation(),this._elevationAlignedLocation):this._elevationAlignedLocation},set:function(e){(0,k.WG)(e,this._location),this._evaluateElevationAlignment(),this._location.z-=this._elevation.offset,this._updateElevationAlignedLocation(),this._updateEngineObject(),this.events.emit("location-update",{location:this._location})}},{key:"_updateElevationAlignedLocation",value:function(){var e=(0,l.pC)(this._elevation.override)?this._elevation.override:this.location.z||0;this._elevationAlignedLocation.x=this.location.x,this._elevationAlignedLocation.y=this.location.y,this._elevationAlignedLocation.z=e+this._elevation.offset,this._elevationAlignedLocation.spatialReference=(0,k.D)(this.location.spatialReference),this._renderLocationDirty=!0,this._screenLocationDirty=!0,this._elevationAlignedLocationDirty=!1}},{key:"grabbableForEvent",value:function(){return!0}},{key:"grabbing",get:function(){return this._grabbing},set:function(e){e!==this._grabbing&&(this._grabbing=e,this._setFocused(this._hovering||this._grabbing),this._updateEngineObject())}},{key:"hovering",get:function(){return this._hovering},set:function(e){e!==this._hovering&&(this._hovering=e,this._setFocused(this._hovering||this._grabbing),this._updateEngineObject())}},{key:"selected",get:function(){return this._selected},set:function(e){e!==this._selected&&(this._selected=e,this._updateEngineObject(),this.events.emit("select-changed",{action:e?"select":"deselect"}))}},{key:"state",get:function(){return this._state},set:function(e){e!==this._state&&(this._state=e,this._updateEngineObject())}},{key:"updateStateEnabled",value:function(e,t){t?this.state|=e:this.state&=~e}},{key:"_setFocused",value:function(e){e!==this._focused&&(this._focused=e,this.events.emit("focus-changed",{action:!0===e?"focus":"unfocus"}))}},{key:"focused",get:function(){return this._focused}},{key:"screenLocation",get:function(){return this._ensureScreenLocation(),this._screenLocation}},{key:"_ensureScreenLocation",value:function(){if(this._screenLocationDirty){var e;if(this._screenLocation.pixelSize=this._camera.computeScreenPixelSizeAt(this.renderLocation),this._screenLocationDirty=!1,D(this._modelTransform)){var t=this._calculateModelTransformOffset(Y);e=(0,g.a)(t,t,this.renderLocation)}else e=this.renderLocation;this._camera.projectToRenderScreen(e,this._screenLocation.renderScreenPointArray),this._camera.renderToScreen(this._screenLocation.renderScreenPointArray,this._screenLocation.screenPointArray)}}},{key:"applyObjectTransform",get:function(){return this._applyObjectTransform},set:function(e){this._applyObjectTransform=e,this._screenLocationDirty=!0,this._updateEngineObject()}},{key:"attached",get:function(){return this._attached}},{key:"intersectionDistance",value:function(e,t){if(!this.available)return null;var n=(0,u.md)(e,x),a=this._getCollisionRadius(t),r=-1*this.collisionPriority;switch(this.collisionType.type){case"point":if((0,_.k)(this.screenLocation.screenPointArray,n)<a*a)return this.screenLocation.renderScreenPointArray[2]+r;break;case"line":var s=this.collisionType.paths,c=this._getWorldToScreenObjectScale(),h=this._calculateObjectTransform(c,W),v=a*this.screenLocation.pixelSize,f=(0,C.u4)(this._camera,n,I);if((0,l.Wi)(f))return null;var p,b=(0,i.Z)(s);try{for(b.s();!(p=b.n()).done;){var m=p.value;if(0!==m.length)for(var S=(0,g.m)(U,m[0],h),A=1;A<m.length;A++){var k=(0,g.m)(V,m[A],h),O=(0,T.Gr)((0,T.zk)(S,k,z),f);if(null!=O&&O<v*v){var P=(0,g.a)(E.WM.get(),S,k);(0,g.g)(P,P,.5);var R=(0,u.So)(E.WM.get());return this._camera.projectToRenderScreen(P,R),R[2]+r}(0,g.c)(S,k)}}}catch(be){b.e(be)}finally{b.f()}break;case"disc":var L,M=this.collisionType.direction,F=null!==(L=this.collisionType.offset)&&void 0!==L?L:y.Z,Z=this._getWorldToScreenObjectScale(),j=this._calculateObjectTransform(Z,W),D=a*this.screenLocation.pixelSize,H=(0,C.u4)(this._camera,n,I);if((0,l.Wi)(H))return null;var Y=(0,d.f)(N,j),K=(0,g.t)(Q,M,Y),J=(0,g.m)(q,F,j);(0,w.Yq)(J,K,B);var X=G;if((0,w.BR)(B,H,X)&&(0,g.d)(X,J)<D*D)return this.screenLocation.renderScreenPointArray[2]+r;break;case"ribbon":var $=this.collisionType,ee=$.paths,te=$.direction,ne=this._getWorldToScreenObjectScale(),ie=this._calculateObjectTransform(ne,W),ae=a*this._camera.computeScreenPixelSizeAt(this.renderLocation),re=(0,C.u4)(this._camera,n,I);if((0,l.Wi)(re))return null;var oe=(0,d.f)(N,ie),se=(0,g.t)(Q,te,oe),ce=this._calculateModelTransformPosition(q);(0,w.Yq)(ce,se,B);var le=G;if(!(0,w.BR)(B,re,le))break;var ue,he=(0,i.Z)(ee);try{for(he.s();!(ue=he.n()).done;){var de=ue.value;if(0!==de.length)for(var ve=(0,g.m)(U,de[0],ie),fe=1;fe<de.length;fe++){var pe=(0,g.m)(V,de[fe],ie),_e=(0,T.Jk)((0,T.zk)(ve,pe,z),le);if(null!=_e&&_e<ae*ae){var ge=(0,g.a)(E.WM.get(),ve,pe);(0,g.g)(ge,ge,.5);var ye=(0,u.So)(E.WM.get());return this._camera.projectToRenderScreen(ge,ye),ye[2]+r}(0,g.c)(ve,pe)}}}catch(be){he.e(be)}finally{he.f()}break;default:(0,o.Bg)(this.collisionType)}return null}},{key:"attach",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{manipulator3D:{}},t=this._stage;if(t){var n=e.manipulator3D;if((0,l.Wi)(n.engineLayerId)){var i=new M.F({pickable:!1,updatePolicy:L.j.SYNC});t.add(i),n.engineLayerId=i.id,this._engineLayer=i}else(null===t||void 0===t?void 0:t.getObject)&&(this._engineLayer=t.getObject(n.engineLayerId));n.engineLayerReferences=(n.engineLayerReferences||0)+1,this._materialIdReferences=n.materialIdReferences,(0,l.Wi)(this._materialIdReferences)&&(this._materialIdReferences=new Map,n.materialIdReferences=this._materialIdReferences),this._camera.copyFrom(this.view.state.camera),this._attached=!0,this._updateEngineObject(),(0,m.Up)(this._location.spatialReference,this.view.spatialReference)||(this.location=new Z.Z({x:0,y:0,z:0,spatialReference:this.view.spatialReference}))}}},{key:"detach",value:function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{manipulator3D:{}}).manipulator3D;e.engineLayerReferences--;var t=0===e.engineLayerReferences;t&&(e.engineLayerId=null),this._removeResourcesFromStage(t),this._engineResources=null,this._engineLayer=null,this._materialIdReferences=null,this._attached=!1}},{key:"onViewChange",value:function(){this._camera.copyFrom(this.view.state.camera),this._screenLocationDirty=!0,this._updateEngineObject()}},{key:"onElevationChange",value:function(e){(0,m.nF)(this.location,K,e.spatialReference)&&(0,S.Qn)(e.extent,K)&&this._notifyLocationChanged()}},{key:"_evaluateElevationAlignment",value:function(){if(!(0,l.Wi)(this.elevationInfo)){var e=null,t=0,n=(0,l.Pt)(this.elevationInfo.offset,0);switch(this.elevationInfo.mode){case"on-the-ground":e=(0,l.Pt)((0,O.KO)(this.view.elevationProvider,this.location,"ground"),0);break;case"relative-to-ground":t=(0,l.Pt)((0,O.KO)(this.view.elevationProvider,this.location,"ground"),0)+n;break;case"relative-to-scene":t=(0,l.Pt)((0,O.KO)(this.view.elevationProvider,this.location,"scene"),0)+n;break;case"absolute-height":t=n}return t!==this._elevation.offset||e!==this._elevation.override?(this._elevation.offset=t,void(this._elevation.override=e)):void 0}}},{key:"_updateEngineObject",value:function(){if(this._attached)if(this.available){var e=this._getWorldToScreenObjectScale(),t=W;if(!0===this.autoScaleRenderObjects){var n=this._getFocusedSize(this._radius,this.focused)*e;this._calculateObjectTransform(n,t)}else this._calculateObjectTransform(e,t);var a,r=this._ensureEngineResources().objectsByState,o=(this.focused?F.Q9.Focused:F.Q9.Unfocused)|(this.selected?F.Q9.Selected:F.Q9.Unselected),s=this._noDisplayCount>0,c=(0,i.Z)(r);try{for(c.s();!(a=c.n()).done;){var l=a.value,u=l.stateMask,h=l.objects;if(s){var d,v=(0,i.Z)(h);try{for(v.s();!(d=v.n()).done;){d.value.visible=!1}}catch(w){v.e(w)}finally{v.f()}}else{var f=(u&F.Q9.All)!==F.Q9.None,p=(u&F.jg.All)!==F.jg.None,_=!f||(o&u)==(u&F.Q9.All),g=!p||(this.state&u)==(u&F.jg.All);if(_&&g){var y,b=(0,i.Z)(h);try{for(b.s();!(y=b.n()).done;){var m=y.value;m.visible=!0,m.transformation=t}}catch(w){b.e(w)}finally{b.f()}}else{var S,T=(0,i.Z)(h);try{for(T.s();!(S=T.n()).done;){S.value.visible=!1}}catch(w){T.e(w)}finally{T.f()}}}}}catch(w){c.e(w)}finally{c.f()}}else this._removeResourcesFromStage()}},{key:"_ensureEngineResources",value:function(){if((0,l.Wi)(this._engineResources)){var e=(0,l.Wg)(this._engineLayer),t=[],n=new Set;this.renderObjects.forEach((function(e){var i=e.geometry.material;n.has(i)||(t.push(i),n.add(i))}));var i=new Map;this._renderObjects.forEach((function(e){var t=new R.T({castShadow:!1,geometries:[e.geometry]}),n=i.get(e.stateMask)||[];n.push(t),i.set(e.stateMask,n)}));var a=[];i.forEach((function(e,t){return a.push({stateMask:t,objects:e})})),this._engineResources={objectsByState:a,layer:e,materials:t}}return this._addResourcesToStage(),this._engineResources}},{key:"_addResourcesToStage",value:function(){var e=this,t=this._stage;if(!this._engineResourcesAddedToStage&&!(0,l.Wi)(this._engineResources)&&t){var n=this._engineResources,i=n.objectsByState,a=n.layer;n.materials.forEach((function(n){var i=(0,l.Wg)(e._materialIdReferences),a=i.get(n.id)||0;0===a&&t.add(n),i.set(n.id,a+1)})),i.forEach((function(e){var n=e.objects;a.addMany(n),t.addMany(n)})),this._engineResourcesAddedToStage=!0}}},{key:"_removeResourcesFromStage",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=this._stage;if(this._engineResourcesAddedToStage&&!(0,l.Wi)(this._engineResources)&&n){var i=this._engineResources,a=i.objectsByState,r=i.layer,o=i.materials;a.forEach((function(e){var t=e.objects;r.removeMany(t),n.removeMany(t)})),o.forEach((function(t){var i=(0,l.Wg)(e._materialIdReferences),a=i.get(t.id);1===a?(n.remove(t),i.delete(t.id)):i.set(t.id,a-1)})),t&&n.remove(r),this._engineResourcesAddedToStage=!1}}},{key:"_getCollisionRadius",value:function(e){return this._getFocusedSize(this.radius,!0)*("touch"===e?this.touchMultiplier:1)}},{key:"_getFocusedSize",value:function(e,t){return e*(t?this.focusMultiplier:1)}},{key:"_getWorldToScreenObjectScale",value:function(){return this._worldSized?1:this.screenLocation.pixelSize}},{key:"_calculateModelTransformPosition",value:function(e){var t=this._getWorldToScreenObjectScale(),n=this._calculateObjectTransform(t,H);return(0,g.s)(e,n[12],n[13],n[14])}},{key:"_calculateModelTransformOffset",value:function(e){var t=this._calculateModelTransformPosition(e);return(0,g.b)(e,t,this.renderLocation)}},{key:"_calculateObjectTransform",value:function(e,t){return(0,f.s)(t,e,0,0,0,0,e,0,0,0,0,e,0,0,0,0,1),this._worldFrame&&(0,f.m)(t,t,this._worldFrame),(0,f.m)(t,t,this._modelTransform),t[12]+=this.renderLocation[0],t[13]+=this.renderLocation[1],t[14]+=this.renderLocation[2],t[15]=1,(0,l.pC)(this._applyObjectTransform)&&this._applyObjectTransform(t),t}},{key:"test",get:function(){var e=!1;if((0,l.pC)(this._engineResources))for(var t in this._engineResources.objectsByState){var n,a=this._engineResources.objectsByState[t],r=(0,i.Z)(a.objects);try{for(r.s();!(n=r.n()).done;){if(n.value.visible){e=!0;break}}}catch(o){r.e(o)}finally{r.f()}if(e)break}return{areAnyResourcesVisible:e}}}]),e}();function D(e){return 0!==e[12]||0!==e[13]||0!==e[14]}var x=(0,u.s1)(),z=(0,T.Ue)(),I=(0,A.Ue)(),N=(0,v.c)(),H=(0,p.c)(),W=(0,p.c)(),B=(0,w.Ue)(),U=(0,y.c)(),V=(0,y.c)(),G=(0,y.c)(),Q=(0,y.c)(),q=(0,y.c)(),Y=(0,y.c)(),K=new Z.Z({x:0,y:0,z:0,spatialReference:null})},40508:function(e,t,n){n.d(t,{r:function(){return o}});var i=n(43144),a=n(15671),r=n(99034),o=(0,i.Z)((function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r.Q9.None;(0,a.Z)(this,e),this.geometry=t,this.stateMask=n}))},83639:function(e,t,n){n.d(t,{Aq:function(){return P},Bz:function(){return E},EA:function(){return T},Gd:function(){return C},Ju:function(){return A},X9:function(){return O},aD:function(){return k}});var i=n(14226),a=n(11186),r=n(71353),o=n(67077),s=n(51378),c=(n(37818),n(35284)),l=n(40508),u=(n(96387),n(91526)),h=n(68401),d=n(40779),v=n(70619),f=n(56529),p=n(4760),_=n(66832),g=n(66156),y=n(24231),b=n(58901),m=n(11606),S=n(99034);function T(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:f.yD.OccludeAndTransparent,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=(0,o.f)(e[0],e[1],e[2],e.length>3?e[3]:1),a=e[3]<1;return n?new m.Q({color:i,transparent:a,writeDepth:!0,cullFace:h.Vr.Back,renderOccluded:t}):new _.E({color:i,transparent:a,writeDepth:!0,cullFace:h.Vr.Back,renderOccluded:t})}var w=Object.freeze({calloutLength:40,calloutWidth:1,discRadius:27,focusMultiplier:1.1,calloutColor:(0,r.f)(1,.5,0)});function A(e,t){var n=new c.Z({view:e,autoScaleRenderObjects:!1,collisionPriority:1,metadata:t.metadata});return E(n,t),n}function E(e,t){var n,i,a,r,s,c,h,_,m=null!==(n=t.material)&&void 0!==n?n:new g.j({transparent:!0,writeDepth:!1,textureId:null===(i=t.texture)||void 0===i?void 0:i.id,renderOccluded:f.yD.Opaque}),T=null!==(a=t.focusMultiplier)&&void 0!==a?a:w.focusMultiplier,A=null!==(r=t.calloutLength)&&void 0!==r?r:w.calloutLength,E=w.discRadius*(null!==(s=t.discScale)&&void 0!==s?s:1),k=E*T,O=function(e,t){var n=[0,1,2,2,3,0];return new d.Z(t,[[p.T.POSITION,new u.a([A-e,-e,0,A+e,-e,0,A+e,e,0,A-e,e,0],3,!0)],[p.T.UV0,new u.a([0,0,1,0,1,1,0,1],2,!0)]],[[p.T.POSITION,n],[p.T.UV0,n]])},C=w.calloutColor,P=null!==(c=t.calloutWidth)&&void 0!==c?c:w.calloutWidth,R=new(P>1?b.U:y.Y)({width:P,color:(0,o.f)(C[0],C[1],C[2],null!==(h=t.calloutOpacity)&&void 0!==h?h:1),renderOccluded:f.yD.OccludeAndTransparent}),L=(0,v.rh)(R,[[0,0,0],[A-E,0,0]]),M=(0,v.rh)(R,[[0,0,0],[A-k,0,0]]),F=null!==(_=t.customStateMask)&&void 0!==_?_:S.jg.None;e.collisionType={type:"disc",direction:[0,0,1],offset:[A,0,0]},e.focusMultiplier=T,e.metadata=t.metadata,e.radius=E,e.renderObjects=[new l.r(O(E,m),S.Q9.Unfocused|F),new l.r(L,S.Q9.Unfocused|F),new l.r(O(k,m),S.Q9.Focused|F),new l.r(M,S.Q9.Focused|F)]}function k(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:S.jg.None,a=T((0,o.f)(t[0],t[1],t[2],null!=n?n:1)),r=[new l.r((0,v.PI)(a,1,32,32),i)];return new c.Z({view:e,renderObjects:r})}var O=Object.freeze({autoScaleRenderObjects:!1,worldSized:!0});function C(e,t,n,r){var o=(0,a.b)(s.WM.get(),e,n),c=P(o,(0,a.f)(s.WM.get(),r,o),n,s.MP.get());(0,i.a)(c,c);var l=(0,a.m)(s.WM.get(),t,c);return Math.atan2(l[1],l[0])}function P(e,t,n,i){var r=(0,a.n)(s.WM.get(),e),o=(0,a.n)(s.WM.get(),t),c=(0,a.f)(s.WM.get(),r,o);return i[0]=r[0],i[1]=r[1],i[2]=r[2],i[3]=0,i[4]=o[0],i[5]=o[1],i[6]=o[2],i[7]=0,i[8]=c[0],i[9]=c[1],i[10]=c[2],i[11]=0,i[12]=n[0],i[13]=n[1],i[14]=n[2],i[15]=1,i}},43505:function(e,t,n){n.d(t,{A:function(){return c}});var i,a=n(30168),r=n(41012),o=n(58406),s=n(98634);function c(e,t){if(t.screenSizeEnabled){var n=e.vertex;(0,r.hY)(n,t),n.uniforms.add(new o.p("perScreenPixelRatio",(function(e,t){return t.camera.perScreenPixelRatio}))),n.uniforms.add(new o.p("screenSizeScale",(function(e){return e.screenSizeScale}))),n.code.add((0,s.H)(i||(i=(0,a.Z)(["float computeRenderPixelSizeAt( vec3 pWorld ){\nvec3 viewForward = - vec3(view[0][2], view[1][2], view[2][2]);\nfloat viewDirectionDistance = abs(dot(viewForward, pWorld - cameraPosition));\nreturn viewDirectionDistance * perScreenPixelRatio;\n}\nvec3 screenSizeScaling(vec3 position, vec3 anchor){\nreturn position * screenSizeScale * computeRenderPixelSizeAt(anchor) + anchor;\n}"]))))}}},66156:function(e,t,n){n.d(t,{j:function(){return j}});var i=n(1413),a=n(15671),r=n(43144),o=n(60136),s=n(29388),c=n(37081),l=n(68401),u=n(17363),h=n(56529),d=n(78041),v=n(93822),f=n(12594),p=n(64642),_=n(11983),g=n(11752),y=n(61120),b=n(27366),m=n(98634),S=n(82144),T=n(31132),w=n(33559),A=n(7566),E=n(27627),k=n(50411),O=n(25920),C=n(8883),P=n(32500),R=n(8548),L=n(36207),M=(m.K,function(e){(0,o.Z)(n,e);var t=(0,s.Z)(n);function n(){return(0,a.Z)(this,n),t.apply(this,arguments)}return(0,r.Z)(n,[{key:"initializeProgram",value:function(e){return new E.$(e.rctx,n.shader.get().build(this.configuration),A.i)}},{key:"_setPipelineState",value:function(e,t){var n=this.configuration,i=e===O.A.NONE,a=e===O.A.FrontFace;return(0,L.sm)({blending:n.output!==c.H.Color&&n.output!==c.H.Alpha||!n.transparent?null:i?F:(0,d.j7)(e),culling:(0,L.zp)(n.cullFace),depthTest:{func:(0,d.Bh)(e)},depthWrite:i?n.writeDepth?L.LZ:null:(0,d.K5)(e),colorWrite:L.BK,stencilWrite:n.hasOccludees?k.s3:null,stencilTest:n.hasOccludees?t?k.eD:k.RY:null,polygonOffset:i||a?null:(0,d.je)(n.enableOffset)})}},{key:"initializePipeline",value:function(){return this._occludeePipelineState=this._setPipelineState(this.configuration.transparencyPassType,!0),this._setPipelineState(this.configuration.transparencyPassType,!1)}},{key:"getPipelineState",value:function(e,t){return t?this._occludeePipelineState:(0,g.Z)((0,y.Z)(n.prototype),"getPipelineState",this).call(this,e,t)}}]),n}(T.A));M.shader=new S.J(P.I,(function(){return n.e(8957).then(n.bind(n,18957))}));var F=(0,L.if)(R.zi.ONE,R.zi.ONE_MINUS_SRC_ALPHA),Z=function(e){(0,o.Z)(n,e);var t=(0,s.Z)(n);function n(){var e;return(0,a.Z)(this,n),(e=t.apply(this,arguments)).output=c.H.Color,e.cullFace=l.Vr.None,e.hasSlicePlane=!1,e.transparent=!1,e.enableOffset=!0,e.writeDepth=!0,e.hasOccludees=!1,e.transparencyPassType=O.A.NONE,e.hasMultipassTerrain=!1,e.cullAboveGround=!1,e}return(0,r.Z)(n)}(C.W);(0,b._)([(0,w.o)({count:c.H.COUNT})],Z.prototype,"output",void 0),(0,b._)([(0,w.o)({count:l.Vr.COUNT})],Z.prototype,"cullFace",void 0),(0,b._)([(0,w.o)()],Z.prototype,"hasSlicePlane",void 0),(0,b._)([(0,w.o)()],Z.prototype,"transparent",void 0),(0,b._)([(0,w.o)()],Z.prototype,"enableOffset",void 0),(0,b._)([(0,w.o)()],Z.prototype,"writeDepth",void 0),(0,b._)([(0,w.o)()],Z.prototype,"hasOccludees",void 0),(0,b._)([(0,w.o)({count:O.A.COUNT})],Z.prototype,"transparencyPassType",void 0),(0,b._)([(0,w.o)()],Z.prototype,"hasMultipassTerrain",void 0),(0,b._)([(0,w.o)()],Z.prototype,"cullAboveGround",void 0);var j=function(e){(0,o.Z)(n,e);var t=(0,s.Z)(n);function n(e){var i;return(0,a.Z)(this,n),(i=t.call(this,e,new x)).supportsEdges=!0,i._configuration=new Z,i}return(0,r.Z)(n,[{key:"getConfiguration",value:function(e,t){return this._configuration.output=e,this._configuration.cullFace=this.parameters.cullFace,this._configuration.hasSlicePlane=this.parameters.hasSlicePlane,this._configuration.transparent=this.parameters.transparent,this._configuration.writeDepth=this.parameters.writeDepth,this._configuration.hasOccludees=this.parameters.hasOccludees,this._configuration.transparencyPassType=t.transparencyPassType,this._configuration.enableOffset=t.camera.relativeElevation<d.ve,this._configuration.hasMultipassTerrain=t.multipassTerrain.enabled,this._configuration.cullAboveGround=t.multipassTerrain.cullAboveGround,this._configuration}},{key:"requiresSlot",value:function(e,t){return(t===c.H.Color||t===c.H.Alpha||t===c.H.Highlight)&&(e===v.r.DRAPED_MATERIAL||(t===c.H.Highlight?e===v.r.OPAQUE_MATERIAL:e===(this.parameters.transparent?this.parameters.writeDepth?v.r.TRANSPARENT_MATERIAL:v.r.TRANSPARENT_DEPTH_WRITE_DISABLED_MATERIAL:v.r.OPAQUE_MATERIAL)))}},{key:"createGLMaterial",value:function(e){return new D(e)}},{key:"createBufferWriter",value:function(){return new f.G(p.W1)}}]),n}(_.c),D=function(e){(0,o.Z)(n,e);var t=(0,s.Z)(n);function n(e){return(0,a.Z)(this,n),t.call(this,(0,i.Z)((0,i.Z)({},e),e.material.parameters))}return(0,r.Z)(n,[{key:"_updateParameters",value:function(e){return this.updateTexture(this._material.parameters.textureId),this._material.setParameters(this.textureBindParameters),this.ensureTechnique(M,e)}},{key:"_updateOccludeeState",value:function(e){e.hasOccludees!==this._material.parameters.hasOccludees&&(this._material.setParameters({hasOccludees:e.hasOccludees}),this._updateParameters(e))}},{key:"beginSlot",value:function(e){return this._output!==c.H.Color&&this._output!==c.H.Alpha||this._updateOccludeeState(e),this._updateParameters(e)}}]),n}(u.F),x=function(e){(0,o.Z)(n,e);var t=(0,s.Z)(n);function n(){var e;return(0,a.Z)(this,n),(e=t.apply(this,arguments)).transparent=!1,e.writeDepth=!0,e.hasSlicePlane=!1,e.cullFace=l.Vr.None,e.hasOccludees=!1,e.opacity=1,e.textureId=null,e.initTextureTransparent=!0,e}return(0,r.Z)(n)}(h.Mt)},11606:function(e,t,n){n.d(t,{Q:function(){return D}});var i=n(15671),a=n(43144),r=n(60136),o=n(29388),s=n(11186),c=n(71353),l=n(67077),u=n(41414),h=n(25158),d=n(55158),v=n(37081),f=n(68401),p=n(23620),_=n(56529),g=n(93822),y=n(97731),b=n(4760),m=n(33236),S=n(22909),T=n(27366),w=n(82144),A=n(31132),E=n(33559),k=n(78041),O=n(27627),C=n(25920),P=n(8883),R=n(72511),L=n(8548),M=n(36207),F=function(e){(0,r.Z)(n,e);var t=(0,o.Z)(n);function n(){return(0,i.Z)(this,n),t.apply(this,arguments)}return(0,a.Z)(n,[{key:"initializeProgram",value:function(e){return new O.$(e.rctx,n.shader.get().build(this.configuration),j)}},{key:"_setPipelineState",value:function(e){var t=this.configuration,n=e===C.A.NONE,i=e===C.A.FrontFace;return(0,M.sm)({blending:t.output!==v.H.Color&&t.output!==v.H.Alpha||!t.transparent?null:n?k.wu:(0,k.j7)(e),culling:(0,M.zp)(t.cullFace),depthTest:{func:i?L.wb.LESS:t.shadingEnabled?L.wb.LEQUAL:L.wb.LESS},depthWrite:n?t.writeDepth?M.LZ:null:(0,k.K5)(e),colorWrite:M.BK,polygonOffset:n||i?null:k.E0})}},{key:"initializePipeline",value:function(){return this._setPipelineState(this.configuration.transparencyPassType)}}]),n}(A.A);F.shader=new w.J(R.S,(function(){return n.e(6556).then(n.bind(n,36556))}));var Z=function(e){(0,r.Z)(n,e);var t=(0,o.Z)(n);function n(){var e;return(0,i.Z)(this,n),(e=t.apply(this,arguments)).output=v.H.Color,e.cullFace=f.Vr.None,e.transparencyPassType=C.A.NONE,e.hasSlicePlane=!1,e.transparent=!1,e.writeDepth=!0,e.screenSizeEnabled=!0,e.shadingEnabled=!0,e.hasMultipassTerrain=!1,e.cullAboveGround=!1,e}return(0,a.Z)(n)}(P.W);(0,T._)([(0,E.o)({count:v.H.COUNT})],Z.prototype,"output",void 0),(0,T._)([(0,E.o)({count:f.Vr.COUNT})],Z.prototype,"cullFace",void 0),(0,T._)([(0,E.o)({count:C.A.COUNT})],Z.prototype,"transparencyPassType",void 0),(0,T._)([(0,E.o)()],Z.prototype,"hasSlicePlane",void 0),(0,T._)([(0,E.o)()],Z.prototype,"transparent",void 0),(0,T._)([(0,E.o)()],Z.prototype,"writeDepth",void 0),(0,T._)([(0,E.o)()],Z.prototype,"screenSizeEnabled",void 0),(0,T._)([(0,E.o)()],Z.prototype,"shadingEnabled",void 0),(0,T._)([(0,E.o)()],Z.prototype,"hasMultipassTerrain",void 0),(0,T._)([(0,E.o)()],Z.prototype,"cullAboveGround",void 0);var j=new Map([[b.T.POSITION,0],[b.T.NORMAL,1],[b.T.OFFSET,2]]),D=function(e){(0,r.Z)(n,e);var t=(0,o.Z)(n);function n(e){var a;return(0,i.Z)(this,n),(a=t.call(this,e,new z)).supportsEdges=!0,a._configuration=new Z,a._vertexAttributeLocations=j,a}return(0,a.Z)(n,[{key:"getConfiguration",value:function(e,t){return this._configuration.output=e,this._configuration.cullFace=this.parameters.cullFace,this._configuration.hasSlicePlane=this.parameters.hasSlicePlane,this._configuration.transparent=this.parameters.transparent,this._configuration.writeDepth=this.parameters.writeDepth,this._configuration.screenSizeEnabled=this.parameters.screenSizeEnabled,this._configuration.shadingEnabled=this.parameters.shadingEnabled,this._configuration.transparencyPassType=t.transparencyPassType,this._configuration.hasMultipassTerrain=t.multipassTerrain.enabled,this._configuration.cullAboveGround=t.multipassTerrain.cullAboveGround,this._configuration}},{key:"intersect",value:function(e,t,n,i,a,r){var o=this;if(this.parameters.screenSizeEnabled){var c=e.vertexAttributes.get(b.T.OFFSET),l={applyToVertex:function(e,t,i,a){var r=(0,s.s)(N,c.data[3*a+0],c.data[3*a+1],c.data[3*a+2]),l=(0,s.s)(H,e,t,i);return(0,s.g)(r,r,o.parameters.screenSizeScale*n.camera.computeRenderPixelSizeAt(r)),(0,s.a)(l,l,r),[l[0],l[1],l[2]]},applyToAabb:function(e){var t=(0,u.be)(e,N);return(0,u.bA)(e,o.parameters.screenSizeScale*n.camera.computeRenderPixelSizeAt(t))}};(0,S.Bw)(e,n,i,a,l,r)}else(0,S.Bw)(e,n,i,a,void 0,r)}},{key:"requiresSlot",value:function(e,t){if(t===v.H.Highlight)return e===g.r.OPAQUE_MATERIAL;if(t===v.H.Color||t===v.H.Alpha||t===v.H.ObjectAndLayerIdColor){var n=g.r.OPAQUE_MATERIAL;return this.parameters.transparent&&(n=this.parameters.writeDepth?g.r.TRANSPARENT_MATERIAL:g.r.TRANSPARENT_DEPTH_WRITE_DISABLED_MATERIAL),e===n||e===g.r.DRAPED_MATERIAL}return!1}},{key:"createGLMaterial",value:function(e){return new x(e)}},{key:"createBufferWriter",value:function(){return new I(this.parameters.screenSizeEnabled)}}]),n}(_.F5),x=function(e){(0,r.Z)(n,e);var t=(0,o.Z)(n);function n(){return(0,i.Z)(this,n),t.apply(this,arguments)}return(0,a.Z)(n,[{key:"beginSlot",value:function(e){return this.ensureTechnique(F,e)}}]),n}(p.Z),z=function(e){(0,r.Z)(n,e);var t=(0,o.Z)(n);function n(){var e;return(0,i.Z)(this,n),(e=t.apply(this,arguments)).color=(0,l.f)(1,1,1,1),e.shadingTint=(0,l.f)(0,0,0,.25),e.shadingDirection=(0,s.n)((0,c.c)(),[.5,-.5,-.5]),e.screenSizeScale=14,e.transparent=!1,e.writeDepth=!0,e.hasSlicePlane=!1,e.cullFace=f.Vr.None,e.screenSizeEnabled=!1,e.shadingEnabled=!0,e}return(0,a.Z)(n)}(_.Mt),I=function(){function e(t){(0,i.Z)(this,e),this.screenSizeEnabled=t;var n=(0,d.U$)().vec3f(b.T.POSITION).vec3f(b.T.NORMAL);this.screenSizeEnabled&&n.vec3f(b.T.OFFSET),this.vertexBufferLayout=n}return(0,a.Z)(e,[{key:"allocate",value:function(e){return this.vertexBufferLayout.createBuffer(e)}},{key:"elementCount",value:function(e){return e.indices.get(b.T.POSITION).length}},{key:"write",value:function(e,t,n,i,a){if((0,m.NK)(n,this.vertexBufferLayout,e,t,i,a),this.screenSizeEnabled){if(!n.vertexAttributes.has(b.T.OFFSET))throw new Error("".concat(b.T.OFFSET," vertex attribute required for screenSizeEnabled ShadedColorMaterial"));var r=n.vertexAttributes.get(b.T.OFFSET),o=n.indices.get(b.T.OFFSET);(0,y.hu)(3===r.size);var s=i.getField(b.T.OFFSET,h.ct);if(!s)throw new Error("unable to acquire view for "+b.T.OFFSET);(0,m.ho)(o,r.data,t,s,a)}}}]),e}(),N=(0,c.c)(),H=(0,c.c)()},70209:function(e,t,n){n.d(t,{Er:function(){return l},Lp:function(){return u},Yq:function(){return h}});var i=n(74165),a=n(15861),r=n(14921),o=n(92026),s=n(66978),c=n(94172);function l(e,t){e.interactive=!0;var n=e.tool,l=e.view;l.activeTool=n;var u=(0,s.fu)(t,(function(){l.activeTool===n&&(l.activeTool=null)}));return(0,r.vr)(function(){var e=(0,a.Z)((0,i.Z)().mark((function e(t){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,c.N1)((function(){return(0,o.Wi)(n)||!n.active}),t);case 2:u=(0,o.hw)(u);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t)}function u(e,t){return(0,c.YP)((function(){return e.interactive}),(function(){return function(e,t){e.interactive?function(e,t){h(e);var n=e.view,i=e.analysis,a=new t({view:n,analysis:i,analysisViewData:e});e.tool=a,n.tools.add(a)}(e,t):h(e)}(e,t)}),c.tX)}function h(e){var t=e.view,n=e.tool;(0,o.Wi)(n)||(t.tools.remove(n),e.tool=null)}},76365:function(e,t,n){n.d(t,{f:function(){return S}});var i,a=n(15671),r=n(43144),o=n(60136),s=n(29388),c=n(27366),l=n(94172),u=n(49861),h=(n(25243),n(63780),n(69912)),d=n(85015),v=n(32718),f=n(92026),p=n(66978),_=n(99034),g=n(37762),y=n(80987);!function(e){e[e.WhenToolEditable=0]="WhenToolEditable",e[e.WhenToolNotEditable=1]="WhenToolNotEditable",e[e.Always=2]="Always"}(i||(i={}));var b=function(){function e(){(0,a.Z)(this,e),this._isToolEditable=!0,this._manipulators=new y.Z,this._resourceContexts={manipulator3D:{}},this._attached=!1}return(0,r.Z)(e,[{key:"isToolEditable",set:function(e){this._isToolEditable=e}},{key:"length",get:function(){return this._manipulators.length}},{key:"add",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i.WhenToolEditable;this.addMany([e],t)}},{key:"addMany",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i.WhenToolEditable,a=(0,g.Z)(e);try{for(a.s();!(t=a.n()).done;){var r={manipulator:t.value,visibilityPredicate:n,attached:!1};this._manipulators.add(r),this._attached&&this._updateManipulatorAttachment(r)}}catch(o){a.e(o)}finally{a.f()}}},{key:"remove",value:function(e){for(var t=0;t<this._manipulators.length;t++)if(this._manipulators.getItemAt(t).manipulator===e){var n=this._manipulators.splice(t,1)[0];this._detachManipulator(n);break}}},{key:"removeAll",value:function(){var e=this;this._manipulators.forEach((function(t){e._detachManipulator(t)})),this._manipulators.removeAll()}},{key:"attach",value:function(){var e=this;this._manipulators.forEach((function(t){e._updateManipulatorAttachment(t)})),this._attached=!0}},{key:"detach",value:function(){var e=this;this._manipulators.forEach((function(t){e._detachManipulator(t)})),this._attached=!1}},{key:"destroy",value:function(){this.detach(),this._manipulators.forEach((function(e){var t=e.manipulator;t.destroy&&t.destroy()})),this._manipulators.destroy(),this._resourceContexts=null}},{key:"on",value:function(e,t){return this._manipulators.on(e,(function(e){t(e)}))}},{key:"forEach",value:function(e){var t,n=(0,g.Z)(this._manipulators.items);try{for(n.s();!(t=n.n()).done;){e(t.value)}}catch(i){n.e(i)}finally{n.f()}}},{key:"some",value:function(e){return this._manipulators.items.some(e)}},{key:"toArray",value:function(){var e=[];return this.forEach((function(t){return e.push(t.manipulator)})),e}},{key:"intersect",value:function(e,t){var n=null,i=Number.MAX_VALUE;return this._manipulators.forEach((function(a){var r=a.manipulator;if(a.attached&&r.interactive){var o=r.intersectionDistance(e,t);(0,f.pC)(o)&&o<i&&(i=o,n=r)}})),n}},{key:"_updateManipulatorAttachment",value:function(e){this._isManipulatorItemVisible(e)?this._attachManipulator(e):this._detachManipulator(e)}},{key:"_attachManipulator",value:function(e){e.attached||(e.manipulator.attach&&e.manipulator.attach(this._resourceContexts),e.attached=!0)}},{key:"_detachManipulator",value:function(e){if(e.attached){var t=e.manipulator;t.grabbing=!1,t.dragging=!1,t.hovering=!1,t.selected=!1,t.detach&&t.detach(this._resourceContexts),e.attached=!1}}},{key:"_isManipulatorItemVisible",value:function(e){return e.visibilityPredicate===i.Always||(this._isToolEditable?e.visibilityPredicate===i.WhenToolEditable:e.visibilityPredicate===i.WhenToolNotEditable)}}]),e}(),m=function(e){(0,o.Z)(n,e);var t=(0,s.Z)(n);function n(e){var i;return(0,a.Z)(this,n),(i=t.call(this,e)).manipulators=new b,i.automaticManipulatorSelection=!0,i.hasGrabbedManipulators=!1,i.hasHoveredManipulators=!1,i.firstGrabbedManipulator=null,i.created=!1,i.removeIncompleteOnCancel=!0,i._editableFlags=new Map([[_.bH.MANAGER,!0],[_.bH.USER,!0]]),i._creationFinishedResolver=(0,p.hh)(),i}return(0,r.Z)(n,[{key:"active",get:function(){return null!=this.view&&this.view.activeTool===this}},{key:"visible",set:function(e){this._get("visible")!==e&&(this._set("visible",e),this._syncVisible())}},{key:"editable",get:function(){return this.getEditableFlag(_.bH.USER)},set:function(e){this.setEditableFlag(_.bH.USER,e)}},{key:"updating",get:function(){return!1}},{key:"cursor",get:function(){return null}},{key:"hasFocusedManipulators",get:function(){return this.hasGrabbedManipulators||this.hasHoveredManipulators}},{key:"destroy",value:function(){this.manipulators.destroy(),this._set("view",null)}},{key:"onAdd",value:function(){this._syncVisible()}},{key:"activate",value:function(){(0,f.Wi)(this.view)?v.Z.getLogger(this.declaredClass).error("Can't activate tool if view is not defined."):(this.view.focus(),this.onActivate())}},{key:"deactivate",value:function(){this.onDeactivate()}},{key:"handleInputEvent",value:function(e){this.onInputEvent(e)}},{key:"handleInputEventAfter",value:function(e){this.onInputEventAfter(e)}},{key:"setEditableFlag",value:function(e,t){this._editableFlags.set(e,t),this.manipulators.isToolEditable=this.internallyEditable,this._updateManipulatorAttachment(),e===_.bH.USER&&this.notifyChange("editable"),this.onEditableChange(),this.onManipulatorSelectionChanged()}},{key:"getEditableFlag",value:function(e){var t;return null!==(t=this._editableFlags.get(e))&&void 0!==t&&t}},{key:"whenCreated",value:function(){return this._creationFinishedResolver.promise}},{key:"onManipulatorSelectionChanged",value:function(){}},{key:"onActivate",value:function(){}},{key:"onDeactivate",value:function(){}},{key:"onShow",value:function(){}},{key:"onHide",value:function(){}},{key:"onEditableChange",value:function(){}},{key:"onInputEvent",value:function(e){}},{key:"onInputEventAfter",value:function(e){}},{key:"internallyEditable",get:function(){return this.getEditableFlag(_.bH.USER)&&this.getEditableFlag(_.bH.MANAGER)}},{key:"finishToolCreation",value:function(){this.created||this._creationFinishedResolver.resolve(this),this._set("created",!0)}},{key:"_syncVisible",value:function(){if(this.initialized)if(this.visible)this._show();else if(this._hide(),this.active)return void(this.view.activeTool=null)}},{key:"_show",value:function(){this._updateManipulatorAttachment(),this.onShow()}},{key:"_hide",value:function(){this._updateManipulatorAttachment(),this.onHide()}},{key:"_updateManipulatorAttachment",value:function(){this.visible?this.manipulators.attach():this.manipulators.detach()}}]),n}(d.Z);(0,c._)([(0,u.Cb)({constructOnly:!0})],m.prototype,"view",void 0),(0,c._)([(0,u.Cb)({readOnly:!0})],m.prototype,"active",null),(0,c._)([(0,u.Cb)({value:!0})],m.prototype,"visible",null),(0,c._)([(0,u.Cb)({value:!0})],m.prototype,"editable",null),(0,c._)([(0,u.Cb)({readOnly:!0})],m.prototype,"manipulators",void 0),(0,c._)([(0,u.Cb)({readOnly:!0})],m.prototype,"updating",null),(0,c._)([(0,u.Cb)()],m.prototype,"cursor",null),(0,c._)([(0,u.Cb)({readOnly:!0})],m.prototype,"automaticManipulatorSelection",void 0),(0,c._)([(0,u.Cb)()],m.prototype,"hasFocusedManipulators",null),(0,c._)([(0,u.Cb)()],m.prototype,"hasGrabbedManipulators",void 0),(0,c._)([(0,u.Cb)()],m.prototype,"hasHoveredManipulators",void 0),(0,c._)([(0,u.Cb)()],m.prototype,"firstGrabbedManipulator",void 0),(0,c._)([(0,u.Cb)({readOnly:!0})],m.prototype,"created",void 0),(0,c._)([(0,u.Cb)({readOnly:!0})],m.prototype,"removeIncompleteOnCancel",void 0);var S=function(e){(0,o.Z)(n,e);var t=(0,s.Z)(n);function n(e){return(0,a.Z)(this,n),t.call(this,e)}return(0,r.Z)(n,[{key:"initialize",value:function(){var e=this;this.addHandles((0,l.YP)((function(){return e.analysisViewData.visible}),(function(t){return e.visible=t}),l.tX))}},{key:"deactivate",value:function(){this.onDeactivate(),this.created||this.analysis.clear()}},{key:"resetCreated",value:function(){this._set("created",!1)}}]),n}(m=(0,c._)([(0,h.j)("esri.views.interactive.InteractiveToolBase")],m));(0,c._)([(0,u.Cb)({constructOnly:!0})],S.prototype,"analysis",void 0),(0,c._)([(0,u.Cb)()],S.prototype,"analysisViewData",void 0),S=(0,c._)([(0,h.j)("esri.views.interactive.AnalysisToolBase")],S)},5693:function(e,t,n){n.d(t,{hM:function(){return h},Xd:function(){return c},di:function(){return l}});var i=n(15671),a=n(43144),r=n(37762),o=(n(59486),n(93169),n(84652)),s=(n(16889),n(92026));n(71353),n(79803),n(37818),n(74509),n(50951),n(65156),n(376),n(69662);n(585);function c(e,t){return e.events.on("drag",function(e,t){var n=null,i=null;return function(a){if("cancel"!==a.action){var r={action:a.action,screenStart:a.start,screenEnd:a.screenPoint};"start"===a.action&&(0,s.Wi)(n)&&(n=new h,i=new h,t(e,n,i,a.pointerType,r)),(0,s.pC)(n)&&n.execute(r),"end"===a.action&&(0,s.pC)(n)&&(n=null,i=null)}else(0,s.pC)(i)&&(i.execute({action:"cancel"}),n=null,i=null)}}(e,t))}function l(e,t){var n,i=new Map,a=(0,r.Z)(t);try{for(a.s();!(n=a.n()).done;){var s=n.value;i.set(s,(0,o.d9)(e[s]))}}catch(c){a.e(c)}finally{a.f()}return function(t){return i.forEach((function(t,n){e[n]=t})),t}}var u=function(){},h=function(){function e(){(0,i.Z)(this,e),this.execute=u}return(0,a.Z)(e,[{key:"next",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new e;return(0,s.pC)(t)&&(this.execute=function(e){var i=t(e);(0,s.pC)(i)&&n.execute(i)}),n}}]),e}()}}]);
//# sourceMappingURL=6370.9ac6acee.chunk.js.map