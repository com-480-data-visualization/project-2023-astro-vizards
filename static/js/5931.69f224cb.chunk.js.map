{"version":3,"file":"static/js/5931.69f224cb.chunk.js","mappings":"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","sources":["../node_modules/@arcgis/core/layers/support/FetchAssociatedFeatureLayer.js","../node_modules/@arcgis/core/views/layers/support/popupUtils.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport{id as t}from\"../../kernel.js\";import r from\"../../request.js\";import{isNone as e,isSome as a}from\"../../core/maybe.js\";import{throwIfAbortError as i}from\"../../core/promiseUtils.js\";import s from\"../FeatureLayer.js\";import n from\"../../portal/Portal.js\";import o from\"../../portal/PortalItem.js\";class l{constructor(t,r,e,a){this._parsedUrl=t,this._portalItem=r,this._apiKey=e,this.signal=a,this._rootDocument=null;const i=this._parsedUrl?.path.match(/^(.*)\\/SceneServer\\/layers\\/([\\d]*)\\/?$/i);i&&(this._urlParts={root:i[1],layerId:parseInt(i[2],10)})}async fetch(){if(!this._urlParts)return null;const t=this._portalItem??await this._portalItemFromServiceItemId();if(e(t))return this._loadFromUrl();const r=await this._findAndLoadRelatedPortalItem(t);return e(r)?null:this._loadFeatureLayerFromPortalItem(r)}async fetchPortalItem(){if(!this._urlParts)return null;const t=this._portalItem??await this._portalItemFromServiceItemId();return e(t)?null:this._findAndLoadRelatedPortalItem(t)}async _fetchRootDocument(){if(a(this._rootDocument))return this._rootDocument;if(e(this._urlParts))return this._rootDocument={},{};const t={query:{f:\"json\",token:this._apiKey},responseType:\"json\",signal:this.signal},i=`${this._urlParts.root}/SceneServer`;try{const e=await r(i,t);this._rootDocument=e.data}catch{this._rootDocument={}}return this._rootDocument}async _fetchServiceOwningPortalUrl(){const e=this._parsedUrl?.path,a=e?t?.findServerInfo(e):null;if(a?.owningSystemUrl)return a.owningSystemUrl;const s=e?e.replace(/(.*\\/rest)\\/.*/i,\"$1\")+\"/info\":null;try{const t=(await r(s,{query:{f:\"json\"},responseType:\"json\",signal:this.signal})).data.owningSystemUrl;if(t)return t}catch(n){i(n)}return null}async _findAndLoadRelatedPortalItem(t){try{return(await t.fetchRelatedItems({relationshipType:\"Service2Service\",direction:\"reverse\"},{signal:this.signal})).find((t=>\"Feature Service\"===t.type))||null}catch(r){return i(r),null}}async _loadFeatureLayerFromPortalItem(t){await t.load({signal:this.signal});const r=await this._findMatchingAssociatedSublayerUrl(t.url??\"\");return new s({url:r,portalItem:t}).load({signal:this.signal})}async _loadFromUrl(){const t=await this._findMatchingAssociatedSublayerUrl(`${this._urlParts?.root}/FeatureServer`);return new s({url:t}).load({signal:this.signal})}async _findMatchingAssociatedSublayerUrl(t){const e=t.replace(/^(.*FeatureServer)(\\/[\\d]*\\/?)?$/i,\"$1\"),a={query:{f:\"json\"},responseType:\"json\",authMode:\"no-prompt\",signal:this.signal},i=this._urlParts?.layerId,s=this._fetchRootDocument(),n=r(e,a),[o,l]=await Promise.all([n,s]),c=l&&l.layers,u=o.data&&o.data.layers;if(!Array.isArray(u))throw new Error(\"expected layers array\");if(Array.isArray(c))for(let r=0;r<Math.min(c.length,u.length);r++){if(c[r].id===i)return`${e}/${u[r].id}`}else if(null!=i&&i<u.length)return`${e}/${u[i].id}`;throw new Error(\"could not find matching associated sublayer\")}async _portalItemFromServiceItemId(){const t=(await this._fetchRootDocument()).serviceItemId;if(!t)return null;const r=new o({id:t,apiKey:this._apiKey}),e=await this._fetchServiceOwningPortalUrl();a(e)&&(r.portal=new n({url:e}));try{return r.load({signal:this.signal})}catch(s){return i(s),null}}}export{l as FetchAssociatedFeatureLayer};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport{isNone as e,isSome as l}from\"../../../core/maybe.js\";import{getFeatureEditFields as p,fixFields as t}from\"../../../layers/support/fieldUtils.js\";async function d(l,d=l.popupTemplate){if(e(d))return[];const s=await d.getRequiredFields(l.fieldsIndex),{lastEditInfoEnabled:i}=d,{objectIdField:n,typeIdField:u,globalIdField:a,relationships:o}=l;if(s.includes(\"*\"))return[\"*\"];const r=i?await p(l):[],f=t(l.fieldsIndex,[...s,...r]);return u&&f.push(u),f&&n&&l.fieldsIndex?.has(n)&&!f.includes(n)&&f.push(n),f&&a&&l.fieldsIndex?.has(a)&&!f.includes(a)&&f.push(a),o&&o.forEach((e=>{const{keyField:p}=e;f&&p&&l.fieldsIndex?.has(p)&&!f.includes(p)&&f.push(p)})),f}function s(e,p){return e.popupTemplate?e.popupTemplate:l(p)&&p.defaultPopupTemplateEnabled&&l(e.defaultPopupTemplate)?e.defaultPopupTemplate:null}export{s as getFetchPopupTemplate,d as getRequiredFields};\n"],"names":["l","t","r","e","a","_this$_parsedUrl","_classCallCheck","this","_parsedUrl","_portalItem","_apiKey","signal","_rootDocument","i","path","match","_urlParts","root","layerId","parseInt","_createClass","key","value","_fetch","_asyncToGenerator","_regeneratorRuntime","mark","_callee","_this$_portalItem","wrap","_context","prev","next","abrupt","t0","_portalItemFromServiceItemId","sent","_loadFromUrl","_findAndLoadRelatedPortalItem","_loadFeatureLayerFromPortalItem","stop","apply","arguments","_fetchPortalItem","_callee2","_this$_portalItem2","_context2","_fetchRootDocument2","_callee3","_e","_context3","query","f","token","responseType","concat","data","_fetchServiceOwningPortalUrl2","_callee4","_this$_parsedUrl2","s","_t","_context4","owningSystemUrl","replace","_findAndLoadRelatedPortalItem2","_callee5","_context5","fetchRelatedItems","relationshipType","direction","find","type","t1","_x","_loadFeatureLayerFromPortalItem2","_callee6","_t$url","_context6","load","_findMatchingAssociatedSublayerUrl","url","portalItem","_x2","_loadFromUrl2","_callee7","_this$_urlParts","_context7","_findMatchingAssociatedSublayerUrl2","_callee8","_this$_urlParts2","n","_yield$Promise$all","_yield$Promise$all2","o","_l","c","u","_r","_context8","authMode","_fetchRootDocument","Promise","all","_slicedToArray","layers","Array","isArray","Error","Math","min","length","id","_x3","_portalItemFromServiceItemId2","_callee9","_context9","serviceItemId","apiKey","_fetchServiceOwningPortalUrl","portal","d","_d","_l$fieldsIndex","_l$fieldsIndex2","_args","undefined","popupTemplate","getRequiredFields","fieldsIndex","lastEditInfoEnabled","objectIdField","typeIdField","globalIdField","relationships","includes","p","_toConsumableArray","push","has","forEach","_l$fieldsIndex3","keyField","defaultPopupTemplateEnabled","defaultPopupTemplate"],"sourceRoot":""}