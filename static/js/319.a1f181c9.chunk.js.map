{"version":3,"file":"static/js/319.a1f181c9.chunk.js","mappings":"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","sources":["../node_modules/@arcgis/core/views/interactive/snapping/featureSources/sceneLayerSource/sceneLayerSnappingUtils.js","../node_modules/@arcgis/core/views/interactive/snapping/featureSources/sceneLayerSource/SceneLayerSnappingSourceWorker.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport{z as s,i as o,a as r}from\"../../../../../chunks/vec3.js\";import{c,g as n}from\"../../../../../chunks/sphere.js\";const t=1e3;function a(t,a,e){const i=c(),m=n(i);return s(m,m,t,.5),s(m,m,a,.5),i[3]=o(m,t),r(m,m,e),i}export{t as MAX_CANDIDATE_COUNT,a as boundsFromEdge};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../../chunks/tslib.es6.js\";import{isNone as t,unwrapOr as s}from\"../../../../../core/maybe.js\";import{throwIfAborted as o}from\"../../../../../core/promiseUtils.js\";import\"../../../../../core/Logger.js\";import\"../../../../../core/accessorSupport/ensureType.js\";import\"../../../../../core/arrayUtils.js\";import\"../../../../../core/Error.js\";import\"../../../../../core/has.js\";import{subclass as i}from\"../../../../../core/accessorSupport/decorators/subclass.js\";import{a as n,i as r}from\"../../../../../chunks/vec3.js\";import{c as d,a as c}from\"../../../../../chunks/vec3f64.js\";import{create as a,fromPoints as p,projectPoint as m}from\"../../../../../geometry/support/lineSegment.js\";import{g as h,m as u}from\"../../../../../chunks/sphere.js\";import{SnappingTypes as g}from\"../../../../../layers/graphics/data/QueryEngineResult.js\";import l from\"../../../../3d/webgl-engine/lib/Octree.js\";import{extractComponentsEdgeLocationsLayout as _}from\"../../../../3d/webgl-engine/lib/edgeRendering/edgeProcessing.js\";import{MAX_CANDIDATE_COUNT as f,boundsFromEdge as b}from\"./sceneLayerSnappingUtils.js\";let j=class{constructor(){this._idToComponent=new Map,this._components=new l((e=>e.bounds)),this._edges=new l((e=>e.bounds)),this._tmpLineSegment=a(),this._tmpP1=d(),this._tmpP2=d(),this._tmpP3=d(),this.remoteClient=null}async fetchCandidates(e,t){await Promise.resolve(),o(t),await this._ensureEdgeLocations(e,t);const s=[];return this._edges.forEachNeighbor((t=>(this._addCandidates(e,t,s),s.length<f)),e.bounds),{result:{candidates:s}}}async _ensureEdgeLocations(e,o){const i=[];if(this._components.forEachNeighbor((e=>{if(t(e.info)){const{id:t,uid:s}=e;i.push({id:t,uid:s})}return!0}),e.bounds),!i.length)return;const n={components:i},r=await this.remoteClient.invoke(\"fetchAllEdgeLocations\",n,s(o,{}));for(const t of r.components)this._setFetchEdgeLocations(t)}async add(e){const t=new E(e.id,e.bounds);return this._idToComponent.set(t.id,t),this._components.add([t]),{result:{}}}async remove(e){const t=this._idToComponent.get(e.id);if(t){const e=[];this._edges.forEachNeighbor((s=>(s.component===t&&e.push(s),!0)),t.bounds),this._edges.remove(e),this._components.remove([t]),this._idToComponent.delete(t.id)}return{result:{}}}_setFetchEdgeLocations(e){const s=this._idToComponent.get(e.id);if(t(s)||e.uid!==s.uid)return;const o=_.createView(e.locations),i=new Array(o.count),n=d(),r=d();for(let t=0;t<o.count;t++){o.position0.getVec(t,n),o.position1.getVec(t,r);const d=b(n,r,e.origin),c=new C(s,t,d);i[t]=c}this._edges.add(i);const{objectIds:c,origin:a}=e;s.info={locations:o,objectIds:c,origin:a}}_addCandidates(e,t,s){const{info:o}=t.component,{origin:i,objectIds:r}=o,d=o.locations,c=d.position0.getVec(t.index,this._tmpP1),a=d.position1.getVec(t.index,this._tmpP2);n(c,c,i),n(a,a,i);const p=r[d.componentIndex.get(t.index)];this._addEdgeCandidate(e,p,c,a,s),this._addVertexCandidate(e,p,c,s),this._addVertexCandidate(e,p,a,s)}_addEdgeCandidate(e,t,s,o,i){if(!(e.types&g.EDGE))return;const n=h(e.bounds),d=p(s,o,this._tmpLineSegment),a=m(d,n,this._tmpP3);u(e.bounds,a)&&i.push({type:\"edge\",objectId:t,target:c(a),distance:r(n,a),start:c(s),end:c(o)})}_addVertexCandidate(e,t,s,o){if(!(e.types&g.VERTEX))return;const i=h(e.bounds);u(e.bounds,s)&&o.push({type:\"vertex\",objectId:t,target:c(s),distance:r(i,s)})}};j=e([i(\"esri.views.interactive.snapping.featureSources.sceneLayerSource.SceneLayerSnappingSourceWorker\")],j);const y=j;class E{constructor(e,t){this.id=e,this.bounds=t,this.info=null,this.uid=++E.uid}}E.uid=0;class C{constructor(e,t,s){this.component=e,this.index=t,this.bounds=s}}export{y as default};\n"],"names":["a","t","e","i","c","m","n","s","o","r","j","_classCallCheck","this","_idToComponent","Map","_components","l","bounds","_edges","_tmpLineSegment","_tmpP1","d","_tmpP2","_tmpP3","remoteClient","_createClass","key","value","_fetchCandidates","_asyncToGenerator","_regeneratorRuntime","mark","_callee","_this","wrap","_context","prev","next","Promise","resolve","_ensureEdgeLocations","abrupt","forEachNeighbor","_addCandidates","length","result","candidates","stop","_x","_x2","apply","arguments","_ensureEdgeLocations2","_callee2","_iterator","_step","_t2","_context2","info","id","uid","push","components","invoke","sent","_createForOfIteratorHelper","done","_setFetchEdgeLocations","err","f","_x3","_x4","_add","_callee3","_context3","E","set","add","_x5","_remove","_callee4","_e","_context4","get","component","remove","delete","_x6","_","locations","Array","count","position0","getVec","position1","b","origin","C","objectIds","index","p","componentIndex","_addEdgeCandidate","_addVertexCandidate","types","g","h","u","type","objectId","target","distance","start","end","y"],"sourceRoot":""}