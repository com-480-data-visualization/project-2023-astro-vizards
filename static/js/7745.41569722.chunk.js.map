{"version":3,"file":"static/js/7745.41569722.chunk.js","mappings":"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","sources":["../node_modules/@arcgis/core/views/3d/layers/SceneLayerView3D.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import t from\"../../../Graphic.js\";import r from\"../../../core/Logger.js\";import{isNone as i,isSome as s,destroyMaybe as o}from\"../../../core/maybe.js\";import{initial as l}from\"../../../core/reactiveUtils.js\";import{property as n}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/accessorSupport/ensureType.js\";import\"../../../core/arrayUtils.js\";import{subclass as a}from\"../../../core/accessorSupport/decorators/subclass.js\";import{WhereClause as u}from\"../../../core/sql/WhereClause.js\";import d from\"../../../layers/support/FeatureFilter.js\";import{getFloorFilterClause as h}from\"../../../layers/support/floorFilterUtils.js\";import p from\"../../../rest/support/Query.js\";import{sceneLayerEditingEnabled as c}from\"../../../support/featureFlags.js\";import{I3SMeshView3D as y}from\"./I3SMeshView3D.js\";import{ForAllFeaturesVisibilityMode as g}from\"./II3SMeshView3D.js\";import{LayerView3D as f}from\"./LayerView3D.js\";import{createInteractiveEditSession as m,processGeometryEdits as _,processAttributeEdits as F}from\"./i3s/attributeEditing.js\";import{createGetFeatureExtent as v}from\"./i3s/I3SGeometryUtil.js\";import{I3SMeshViewFilter as j}from\"./i3s/I3SMeshViewFilter.js\";import{NodeFilterImpact as w}from\"./i3s/I3SNode.js\";import{I3SOverrides as I}from\"./i3s/I3SOverrides.js\";import{I3SQueryEngine as S}from\"./i3s/I3SQueryEngine.js\";import{I3SQueryFeatureAdapter as b}from\"./i3s/I3SQueryFeatureAdapter.js\";import{I3SQueryFeatureStore as E}from\"./i3s/I3SQueryFeatureStore.js\";import{checkRecyclable as C,getIndexCrs as x,objectIdFilter as Q}from\"./i3s/I3SUtil.js\";import{DefinitionExpressionSceneLayerView as O}from\"./support/DefinitionExpressionSceneLayerView.js\";import{defineFieldProperties as q}from\"./support/fieldProperties.js\";import{PopupSceneLayerView as D}from\"./support/PopupSceneLayerView.js\";import{SceneLayerViewRequiredFields as R}from\"./support/SceneLayerViewRequiredFields.js\";import{updatingProgress as H}from\"../support/updatingProperties.js\";import L from\"../../layers/SceneLayerView.js\";import{TaskPriority as A}from\"../../support/Scheduler.js\";const V=q();let U=class extends(y(O(D(f(L))))){constructor(){super(...arguments),this.type=\"scene-layer-3d\",this.progressiveLoadFactor=1,this._elevationContext=\"scene\",this._isIntegratedMesh=!1,this._supportsLabeling=!0,this._interactiveEditingSessions=new Map,this._queryEngine=null}get i3slayer(){return this.layer}tryRecycleWith(e,t){return e.url===this.layer.url&&this.i3sOverrides.isEmpty?e.load(t).then((()=>{C(this.layer,e,this.i3sOverrides),this.layer=e,this.i3sOverrides.destroy();const t=this.view.resourceController?.memoryController;this.i3sOverrides=new I({view:this.view,layer:e,memoryController:t}),this.resetHighlights()})):null}get layerPopupEnabled(){return this.layer.popupEnabled}get filter(){return this._get(\"filter\")}set filter(e){this._set(\"filter\",j.checkSupport(e)?e:null)}get viewFilter(){const e=this.filter,t=this.layerFilter;if(i(e)&&i(t))return null;const r=this._get(\"viewFilter\");return i(r)?new j({layerFilter:t,viewFilter:e,layerFieldsIndex:this.layer.fieldsIndex,loadAsyncModule:e=>this._loadAsyncModule(e),addSqlFilter:(e,t)=>this.addSqlFilter(e,t,this.logError)}):(r.viewFilter=e,r.layerFilter=t,r)}get requiredFields(){return this._fieldsHelper?.requiredFields??[]}get _floorFilterClause(){const e=h(this);return s(e)?u.create(e,this.layer.fieldsIndex):null}get _excludeObjectIdsSorted(){let e=this.layer.excludeObjectIds.toArray();return c()&&this.i3sOverrides.is3DOFL&&this.i3sOverrides.geometryChangedObjectIds.length>0&&(e=e.concat(this.i3sOverrides.geometryChangedObjectIds)),e.length?e.sort(((e,t)=>e-t)):null}get _objectQualitySettings(){return this.view?.qualitySettings?.sceneService?.object}get lodFactor(){return this._objectQualitySettings?.lodFactor??1}get lodCrossfadeinDuration(){return this._objectQualitySettings.lodCrossfadeinDuration??0}get lodCrossfadeoutDuration(){return this._objectQualitySettings.lodCrossfadeoutDuration??0}get lodCrossfadeUncoveredDuration(){return this._objectQualitySettings.lodCrossfadeUncoveredDuration??0}get updatingProgressValue(){return this._controller?.updatingProgress??0}initialize(){this._fieldsHelper=new R({layerView:this}),this.updatingHandles.add((()=>this.layer.rangeInfos),(e=>this._rangeInfosChanged(e)),l),this.updatingHandles.add((()=>this.layer.renderer),(e=>this.updatingHandles.addPromise(this._rendererChange(e))),l);const e=()=>this._filterChange();this.updatingHandles.add((()=>this.parsedDefinitionExpression),e),this.updatingHandles.add((()=>this.filter),e),this.updatingHandles.add((()=>this._floorFilterClause),e),this.updatingHandles.add((()=>this._excludeObjectIdsSorted),e),this.updatingHandles.add((()=>s(this.viewFilter)?this.viewFilter.sortedObjectIds:null),e),this.updatingHandles.add((()=>s(this.viewFilter)?this.viewFilter.parsedWhereClause:null),e),this.updatingHandles.add((()=>[s(this.viewFilter)?this.viewFilter.parsedGeometry:null,s(this.filter)?this.filter.spatialRelationship:null,s(this.layer.filter)?this.layer.filter.spatialRelationship:null]),(()=>this._geometryFilterChange())),this.handles.add(this.layer.on(\"apply-edits\",(e=>this.updatingHandles.addPromise(e.result)))),this.handles.add(this.layer.on(\"edits\",(e=>this._handleEdits(e))))}destroy(){this._fieldsHelper=o(this._fieldsHelper)}_rangeInfosChanged(e){null!=e&&e.length>0&&r.getLogger(this.declaredClass).warn(\"Unsupported property: rangeInfos are currently only serialized to and from web scenes but do not affect rendering.\")}createQuery(){const e={outFields:[\"*\"],returnGeometry:!1,outSpatialReference:this.view.spatialReference};return s(this.filter)?this.filter.createQuery(e):new p(e)}queryExtent(e,t){return this._ensureQueryEngine().executeQueryForExtent(this._ensureQuery(e),t?.signal)}queryFeatureCount(e,t){return this._ensureQueryEngine().executeQueryForCount(this._ensureQuery(e),t?.signal)}queryFeatures(e,t){return this._ensureQueryEngine().executeQuery(this._ensureQuery(e),t?.signal).then((e=>{if(!e?.features)return e;const t=this.layer;for(const r of e.features)r.layer=t,r.sourceLayer=t;return e}))}queryObjectIds(e,t){return this._ensureQueryEngine().executeQueryForIds(this._ensureQuery(e),t?.signal)}_ensureQueryEngine(){return this._queryEngine||(this._queryEngine=this._createQueryEngine()),this._queryEngine}_createQueryEngine(){const e=v(this.view.spatialReference,this.view.renderSpatialReference,this._collection);return new S({layerView:this,priority:A.FEATURE_QUERY_ENGINE,spatialIndex:new E({featureAdapter:new b({objectIdField:this.layer.objectIdField,attributeStorageInfo:this.layer.attributeStorageInfo??[],getFeatureExtent:e}),forAllFeatures:(e,t)=>this._forAllFeatures(((t,r,i)=>e({id:t,index:r,meta:i})),t,g.ALL_IN_CLIPPING_AREA),getFeatureExtent:e,sourceSpatialReference:x(this.layer),viewSpatialReference:this.view.spatialReference})})}highlight(e){const t=this._highlights;if(e instanceof p){const{set:r,handle:i}=t.acquireSet();return this.queryObjectIds(e).then((e=>t.setFeatureIds(r,e))),i}return super.highlight(e)}createInteractiveEditSession(e){return m(this._attributeEditingContext,e)}_createLayerGraphic(e){const r=new t(null,null,e);return r.layer=this.layer,r.sourceLayer=this.layer,r}canResume(){return super.canResume()&&(!this._controller||this._controller.rootNodeVisible)}getFilters(){const e=super.getFilters(),t=this._excludeObjectIdsSorted;return s(t)&&e.push((e=>Q(t,!1,e))),this._floorFilterClause&&this.addSqlFilter(e,this._floorFilterClause,this.logError),this.addSqlFilter(e,this.parsedDefinitionExpression,this.logError),s(this.viewFilter)&&this.viewFilter.addFilters(e,this.view,this._controller.crsIndex,this._collection),e}isUpdating(){return super.isUpdating()||this.layerFilterUpdating||s(this.viewFilter)&&this.viewFilter.updating||s(this.i3sOverrides)&&this.i3sOverrides.updating}_ensureQuery(e){return this._addDefinitionExpressionToQuery(i(e)?this.createQuery():p.from(e))}get _attributeEditingContext(){return{sessions:this._interactiveEditingSessions,fieldsIndex:this.layer.fieldsIndex,objectIdField:this._getObjectIdField(),forEachNode:e=>this._forAllNodes((t=>s(t)?e(t.node,t.featureIds):null)),attributeStorageInfo:this.i3slayer.attributeStorageInfo??[],i3sOverrides:this.i3sOverrides,getAttributeData:e=>this.getAttributeData(e),setAttributeData:(e,t)=>this.setAttributeData(e,t),clearMemCache:()=>this.clearMemCache()}}_handleEdits(e){c()&&_(this._attributeEditingContext,e),F(this._attributeEditingContext,e)}get hasGeometryFilter(){const e=this.viewFilter;return s(e)&&s(e.parsedGeometry)}computeNodeFiltering(e){const t=this.viewFilter;return i(t)||!this.view.spatialReference||t.isMBSGeometryVisible(e,this.view.spatialReference,this._controller.crsIndex)?w.Unmodified:w.Culled}};e([n()],U.prototype,\"i3slayer\",null),e([n(H)],U.prototype,\"updatingProgress\",void 0),e([n({type:d})],U.prototype,\"filter\",null),e([n({readOnly:!0})],U.prototype,\"viewFilter\",null),e([n(V.requiredFields)],U.prototype,\"requiredFields\",null),e([n(V.availableFields)],U.prototype,\"availableFields\",void 0),e([n()],U.prototype,\"_fieldsHelper\",void 0),e([n()],U.prototype,\"_floorFilterClause\",null),e([n()],U.prototype,\"_excludeObjectIdsSorted\",null),e([n()],U.prototype,\"_objectQualitySettings\",null),e([n()],U.prototype,\"lodFactor\",null),e([n()],U.prototype,\"updatingProgressValue\",null),U=e([a(\"esri.views.3d.layers.SceneLayerView3D\")],U);const P=U;export{P as default};\n"],"names":["V","q","U","_y","_inherits","_super","_createSuper","_this","_classCallCheck","apply","arguments","type","progressiveLoadFactor","_elevationContext","_isIntegratedMesh","_supportsLabeling","_interactiveEditingSessions","Map","_queryEngine","_createClass","key","get","this","layer","value","e","t","_this2","url","i3sOverrides","isEmpty","load","then","_this2$view$resourceC","C","destroy","view","resourceController","memoryController","I","resetHighlights","popupEnabled","_get","set","_set","j","_this3","filter","layerFilter","i","r","viewFilter","layerFieldsIndex","fieldsIndex","loadAsyncModule","_loadAsyncModule","addSqlFilter","logError","_this$_fieldsHelper$r","_this$_fieldsHelper","_fieldsHelper","requiredFields","h","s","u","excludeObjectIds","toArray","c","is3DOFL","geometryChangedObjectIds","length","concat","sort","_this$view","_this$view$qualitySet","_this$view$qualitySet2","qualitySettings","sceneService","object","_this$_objectQualityS","_this$_objectQualityS2","_objectQualitySettings","lodFactor","_this$_objectQualityS3","lodCrossfadeinDuration","_this$_objectQualityS4","lodCrossfadeoutDuration","_this$_objectQualityS5","lodCrossfadeUncoveredDuration","_this$_controller$upd","_this$_controller","_controller","updatingProgress","_this4","R","layerView","updatingHandles","add","rangeInfos","_rangeInfosChanged","l","renderer","addPromise","_rendererChange","_filterChange","parsedDefinitionExpression","_floorFilterClause","_excludeObjectIdsSorted","sortedObjectIds","parsedWhereClause","parsedGeometry","spatialRelationship","_geometryFilterChange","handles","on","result","_handleEdits","o","declaredClass","warn","outFields","returnGeometry","outSpatialReference","spatialReference","createQuery","p","_ensureQueryEngine","executeQueryForExtent","_ensureQuery","signal","executeQueryForCount","_this5","executeQuery","features","_step","_iterator","_createForOfIteratorHelper","n","done","sourceLayer","err","f","executeQueryForIds","_createQueryEngine","_this$layer$attribute","_this6","v","renderSpatialReference","_collection","S","priority","A","spatialIndex","E","featureAdapter","b","objectIdField","attributeStorageInfo","getFeatureExtent","forAllFeatures","_forAllFeatures","id","index","meta","g","sourceSpatialReference","x","viewSpatialReference","_highlights","_t$acquireSet","acquireSet","handle","queryObjectIds","setFeatureIds","_getPrototypeOf","prototype","call","m","_attributeEditingContext","rootNodeVisible","push","Q","addFilters","crsIndex","layerFilterUpdating","updating","_addDefinitionExpressionToQuery","_this$i3slayer$attrib","_this7","sessions","_getObjectIdField","forEachNode","_forAllNodes","node","featureIds","i3slayer","getAttributeData","setAttributeData","clearMemCache","_","F","isMBSGeometryVisible","w","y","O","D","L","H","d","readOnly","availableFields","P","a"],"sourceRoot":""}